({607:function(){var e=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}l((n=n.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},r=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,o++)n[o]=a[i];return n},n=function(){function n(){}return n.processQueue=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.debug("Processing Queue ->",e),"string"==typeof e[0]&&n[e[0]].apply(n,e.slice(1))},n.processOldQueue=function(e){var t=this;e.forEach((function(e){t.processQueue.apply(t,e)}))},n.setCallback=function(e,t){this[e]=t},n.init=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this.debug("SDK Initialization");var r=["score","highScore",e,t];if(!this.isLoaded){window.parent.postMessage({controller:"_digitapGame",type:"SDK_SETTINGS",ui:r,ready:!0},"*"),this.listenGameboxEvents(),this.listenStreamrEvents();var n=document.getElementsByTagName("canvas"),o=document.getElementsByTagName("html");setTimeout((function(){var e=n[0].getAttribute("style");n[0].setAttribute("style",e+"width: 100%; margin: 0; padding: 0; user-select: none; -webkit-user-select: none; -moz-user-select: none;");var t=o[0].getAttribute("style");o[0].setAttribute("style",(t||"")+"user-select: none; -webkit-user-select: none; -moz-user-select: none;")}),2e3)}this.isLoaded=!0},n.setProgress=function(e,t,r){this.progress={type:"SDK_PLAYER_SCORE_UPDATE",state:e,score:t,level:r,continueScore:t,controller:"_digitapGame"},this.sendData()},n.setLevelUp=function(e){this.progress.level=e,this.progress.type="SDK_PLAYER_LEVEL_UP",this.sendData()},n.setPlayerFailed=function(e){void 0===e&&(e="FAIL"),this.progress.state=e,this.progress.score=0,this.progress.type="SDK_PLAYER_FAILED",this.sendData()},n.sendData=function(){window.parent.postMessage(this.progress,this.origin)},n.listenGameboxEvents=function(){var e=this;window.addEventListener("message",(function(t){if(n.debug("Event Received -> %o -> %o",t.data,t.origin),"object"==typeof t.data&&t.data.controller&&"_digitapApp"==t.data.controller){var r=e.allowedOrigins.indexOf(t.origin);if(-1===r)return void n.debug("Error: Origin not allowed inside game container!");if(e.origin=e.allowedOrigins[r],t.data.type)switch(t.data.type){case"SDK_START_GAME":e.afterStartGame();break;case"SDK_PAUSE_GAME":e.afterPauseGame();break;case"SDK_START_GAME_FROM_ZERO":e.progress.score=0,e.progress.level=0,e.progress.continueScore=0,e.afterStartGameFromZero();break;case"SDK_CONTINUE_WITH_CURRENT_SCORE":e.progress.score=e.progress.continueScore,e.afterContinueWithCurrentScore(e.progress.score,e.progress.level);break;default:n.debug('Error: `data.type` = "'+t.data.type+'" not found! Please check `readme.md` of data collector package!')}else n.debug("Error: `event.data.type` should be implemented!")}}),!1)},n.listenStreamrEvents=function(){var r=this,o=this;o.debug("Init Streamr v1.0.8"),window.addEventListener("message",(function(a){return e(r,void 0,void 0,(function(){var e,r,i,s,l,c,u;return t(this,(function(t){try{if(n.debug("Streamr Event received",a.data),!a.data||"object"!=typeof a.data)return[2];if(e=a.data,r=e.controller,i=e.type,s=e.action,l=e.offer,c=e.tournament_id,u=e.username,n.debug("Streamr Event details: ",r,i,s,l,c,u),"_digitapApp"!==r&&"webrtc"!==i)return[2]}catch(e){o.debug("__WEBRTC__",e.message)}return[2]}))}))}))},n.afterStartGameFromZero=function(){},n.afterContinueWithCurrentScore=function(e,t){},n.afterStartGame=function(){},n.afterPauseGame=function(){},n.debug=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];window,console.log.apply(console,r(["DigitapGamePlayerSDK -> "+e],t))},n.gameObject=null,n.isLoaded=!1,n.origin=null,n.isDebugging=!1,n.allowedOrigins=["https://build.digitap.dev","https://wam.app","https://app.wam.app","https://wam.eu","https://play.wam.app","https://stage.wam.app","http://localhost:63342","http://localhost:8080","http://localhost:3000","http://localhost:3001","https://localhost:3001","http://127.0.0.1:3001","https://127.0.0.1:3001"],n.progress={controller:"_digitapGame",type:"SDK_PLAYER_SCORE_UPDATE",score:0,level:0,state:null,continueScore:0},n}();if(void 0!==window.digitapSDK){var o=window.digitapSDK.q;n.processOldQueue(o)}window.digitapSDK=n.processQueue,window.console.log,window.console.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!0}}})[607]();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nYW1lLXBsYXllci1zZGsvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vZ2FtZS1wbGF5ZXItc2RrL3dlYnBhY2svc3RhcnR1cCJdLCJuYW1lcyI6WyJwcm9jZXNzUXVldWUiLCJEaWdpdGFwR2FtZVBsYXllclNESyIsImRlYnVnIiwiYXJncyIsImFwcGx5Iiwic2xpY2UiLCJwcm9jZXNzT2xkUXVldWUiLCJxdWV1ZSIsImZvckVhY2giLCJzZXRDYWxsYmFjayIsImZuIiwiY2FsbGJhY2siLCJ0aGlzIiwiaW5pdCIsImhhc1Njb3JlIiwiaGFzSGlnaFNjb3JlIiwidWlPcHRpb25zIiwiaXNMb2FkZWQiLCJ3aW5kb3ciLCJwYXJlbnQiLCJwb3N0TWVzc2FnZSIsImNvbnRyb2xsZXIiLCJ0eXBlIiwidWkiLCJyZWFkeSIsImxpc3RlbkdhbWVib3hFdmVudHMiLCJsaXN0ZW5TdHJlYW1yRXZlbnRzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInNldFRpbWVvdXQiLCJjYW52YXNTdHlsZSIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsImh0bWxTdHlsZSIsInNldFByb2dyZXNzIiwic3RhdGUiLCJzY29yZSIsImxldmVsIiwicHJvZ3Jlc3MiLCJjb250aW51ZVNjb3JlIiwic2VuZERhdGEiLCJzZXRMZXZlbFVwIiwic2V0UGxheWVyRmFpbGVkIiwib3JpZ2luIiwic2VsZiIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImRhdGEiLCJvcmlnaW5JbmRleCIsImFsbG93ZWRPcmlnaW5zIiwiaW5kZXhPZiIsImFmdGVyU3RhcnRHYW1lIiwiYWZ0ZXJQYXVzZUdhbWUiLCJhZnRlclN0YXJ0R2FtZUZyb21aZXJvIiwiYWZ0ZXJDb250aW51ZVdpdGhDdXJyZW50U2NvcmUiLCJhY3Rpb24iLCJvZmZlciIsInRvdXJuYW1lbnRfaWQiLCJ1c2VybmFtZSIsImVyciIsIm1lc3NhZ2UiLCJjb25zb2xlIiwibG9nIiwicGFy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cUIsQ0FDbENqQixXQUFZLGVBQ1pDLEtBQU0sMEJBQ05jLE1BQU8sRUFDUEMsTUFBTyxFQUNQRixNQUFPLEtBQ1BJLGNBQWUsR0FzZm5CLEVBbGhCQSxHQXFoQkEsUUFBd0MsSUFBdkJyQixPQUFRZ0QsV0FBNEIsQ0FDbkQsSUFBSUMsRUFBaUJqRCxPQUFRZ0QsV0FBV0UsRUFDeENuRSxFQUFxQkssZ0JBQWdCNkQsR0FJakNqRCxPQUFRZ0QsV0FBYWpFLEVBQXFCRCxhQUdwQ2tCLE9BQU8yQyxRQUFRQyxJQUMzQjVDLE9BQU8yQyxRQUFRQyxJQUFNLFcsSUFBVSxzREFDN0IsT0FBTyxNQzFpQlciLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ0eXBlIFByb2dyZXNzID0ge1xuICBjb250cm9sbGVyOiBzdHJpbmc7XG4gIHR5cGU6IHN0cmluZztcbiAgc2NvcmU6IG51bWJlcjtcbiAgbGV2ZWw6IG51bWJlcjtcbiAgc3RhdGU6IGFueTtcbiAgY29udGludWVTY29yZTogbnVtYmVyO1xufTtcblxuaW50ZXJmYWNlIENhbnZhc0VsZW1lbnQgZXh0ZW5kcyBIVE1MQ2FudmFzRWxlbWVudCB7XG4gIGNhcHR1cmVTdHJlYW0oZnJhbWVSYXRlPzogbnVtYmVyKTogTWVkaWFTdHJlYW07XG59XG5cbmNsYXNzIERpZ2l0YXBHYW1lUGxheWVyU0RLIHtcbiAgcHVibGljIHN0YXRpYyBnYW1lT2JqZWN0OiBhbnkgPSBudWxsO1xuICBwcml2YXRlIHN0YXRpYyBpc0xvYWRlZDogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIHN0YXRpYyBvcmlnaW46IHN0cmluZyA9IG51bGw7XG4gIHByaXZhdGUgc3RhdGljIGlzRGVidWdnaW5nOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYWxsb3dlZE9yaWdpbnM6IHN0cmluZ1tdID0gW1xuICAgIFwiaHR0cHM6Ly9idWlsZC5kaWdpdGFwLmRldlwiLFxuICAgIFwiaHR0cHM6Ly93YW0uYXBwXCIsXG4gICAgXCJodHRwczovL2FwcC53YW0uYXBwXCIsXG4gICAgXCJodHRwczovL3dhbS5ldVwiLFxuICAgIFwiaHR0cHM6Ly9wbGF5LndhbS5hcHBcIixcbiAgICBcImh0dHBzOi8vc3RhZ2Uud2FtLmFwcFwiLFxuICAgIFwiaHR0cDovL2xvY2FsaG9zdDo2MzM0MlwiLFxuICAgIFwiaHR0cDovL2xvY2FsaG9zdDo4MDgwXCIsXG4gICAgXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIixcbiAgICBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMVwiLFxuICAgIFwiaHR0cHM6Ly9sb2NhbGhvc3Q6MzAwMVwiLFxuICAgIFwiaHR0cDovLzEyNy4wLjAuMTozMDAxXCIsXG4gICAgXCJodHRwczovLzEyNy4wLjAuMTozMDAxXCIsXG4gIF07XG5cbiAgcHJpdmF0ZSBzdGF0aWMgcHJvZ3Jlc3M6IFByb2dyZXNzID0ge1xuICAgIGNvbnRyb2xsZXI6IFwiX2RpZ2l0YXBHYW1lXCIsXG4gICAgdHlwZTogXCJTREtfUExBWUVSX1NDT1JFX1VQREFURVwiLFxuICAgIHNjb3JlOiAwLFxuICAgIGxldmVsOiAwLFxuICAgIHN0YXRlOiBudWxsLFxuICAgIGNvbnRpbnVlU2NvcmU6IDAsXG4gIH07XG5cbiAgLyoqXG4gICAqIENhbGwgYSBtZXRob2QgZnJvbSB0aGUgY2xhc3MsXG4gICAqIHRocm91Z2ggYSBxdWV1ZS5cbiAgICpcbiAgICogQHBhcmFtIGFyZ3MgYXJyYXlcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgcHJvY2Vzc1F1ZXVlKC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgRGlnaXRhcEdhbWVQbGF5ZXJTREsuZGVidWcoXCJQcm9jZXNzaW5nIFF1ZXVlIC0+XCIsIGFyZ3MpO1xuXG4gICAgaWYgKHR5cGVvZiBhcmdzWzBdID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBEaWdpdGFwR2FtZVBsYXllclNES1tcbiAgICAgICAgYXJnc1swXSBhc1xuICAgICAgICAgIHwgXCJpbml0XCJcbiAgICAgICAgICB8IFwic2V0UHJvZ3Jlc3NcIlxuICAgICAgICAgIHwgXCJzZXRMZXZlbFVwXCJcbiAgICAgICAgICB8IFwic2V0UGxheWVyRmFpbGVkXCJcbiAgICAgICAgICB8IFwic2V0Q2FsbGJhY2tcIlxuICAgICAgXS5hcHBseShEaWdpdGFwR2FtZVBsYXllclNESywgYXJncy5zbGljZSgxKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFByb2Nlc3MgYSBjdXJyZW50IHF1ZXVlLlxuICAgKlxuICAgKiBAcGFyYW0gcXVldWUgYXJyYXlcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgcHJvY2Vzc09sZFF1ZXVlKHF1ZXVlOiBbXSk6IHZvaWQge1xuICAgIHF1ZXVlLmZvckVhY2goKGFyZ3M6IGFueSkgPT4ge1xuICAgICAgdGhpcy5wcm9jZXNzUXVldWUoLi4uYXJncyk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyBhIGNhbGxiYWNrIG1ldGhvZC5cbiAgICpcbiAgICogQHBhcmFtIGZuIHN0cmluZ1xuICAgKiBAcGFyYW0gY2FsbGJhY2sgZnVuY3Rpb25cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc2V0Q2FsbGJhY2soXG4gICAgZm46XG4gICAgICB8IFwiYWZ0ZXJTdGFydEdhbWVGcm9tWmVyb1wiXG4gICAgICB8IFwiYWZ0ZXJDb250aW51ZVdpdGhDdXJyZW50U2NvcmVcIlxuICAgICAgfCBcImFmdGVyU3RhcnRHYW1lXCJcbiAgICAgIHwgXCJhZnRlclBhdXNlR2FtZVwiLFxuICAgIGNhbGxiYWNrOiBhbnlcbiAgKTogdm9pZCB7XG4gICAgdGhpc1tmbl0gPSBjYWxsYmFjaztcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0IGEgbmV3IGdhbWUgY29ubmVjdGlvbiB3aXRoXG4gICAqIHRoZSBwYXJlbnQgcGxhdGZvcm0uXG4gICAqXG4gICAqIEBwYXJhbSB1aU9wdGlvbnMgYXJyYXlcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgaW5pdChcbiAgICBoYXNTY29yZTogYm9vbGVhbiA9IHRydWUsXG4gICAgaGFzSGlnaFNjb3JlOiBib29sZWFuID0gdHJ1ZVxuICApOiB2b2lkIHtcbiAgICB0aGlzLmRlYnVnKFwiU0RLIEluaXRpYWxpemF0aW9uXCIpO1xuXG4gICAgLy8gSW5pdCB0aGUgdWlPcHRpb25zXG4gICAgY29uc3QgdWlPcHRpb25zID0gW1wic2NvcmVcIiwgXCJoaWdoU2NvcmVcIiwgaGFzU2NvcmUsIGhhc0hpZ2hTY29yZV07XG5cbiAgICAvLyBJZiBTREsgaXMgbm90IGxvYWRlZCB5ZXRcbiAgICBpZiAoIXRoaXMuaXNMb2FkZWQpIHtcbiAgICAgIC8vIFNlbmQgdGhlIGluaXQgbWVzc2FnZVxuICAgICAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZShcbiAgICAgICAge1xuICAgICAgICAgIGNvbnRyb2xsZXI6IFwiX2RpZ2l0YXBHYW1lXCIsXG4gICAgICAgICAgdHlwZTogXCJTREtfU0VUVElOR1NcIixcbiAgICAgICAgICB1aTogdWlPcHRpb25zLFxuICAgICAgICAgIHJlYWR5OiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBcIipcIlxuICAgICAgKTtcblxuICAgICAgLy8gV2F0Y2ggZm9yIG1lc3NhZ2VzIGZyb20gR2FtZUJveFxuICAgICAgdGhpcy5saXN0ZW5HYW1lYm94RXZlbnRzKCk7XG5cbiAgICAgIC8vIFdhdGNoIGZvciBtZXNzYWdlcyBmcm9tIFN0cmVhbXJcbiAgICAgIHRoaXMubGlzdGVuU3RyZWFtckV2ZW50cygpO1xuXG4gICAgICAvLyBTZXQgdGhlIGNhbnZhcyBmdWxsd2lkdGggJiBibHVlIHNjcmVlbiBmaXhcbiAgICAgIGNvbnN0IGNhbnZhczogSFRNTENvbGxlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImNhbnZhc1wiKTtcbiAgICAgIGNvbnN0IGh0bWw6IEhUTUxDb2xsZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJodG1sXCIpO1xuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgbGV0IGNhbnZhc1N0eWxlID0gY2FudmFzWzBdLmdldEF0dHJpYnV0ZShcInN0eWxlXCIpO1xuICAgICAgICBjYW52YXNbMF0uc2V0QXR0cmlidXRlKFxuICAgICAgICAgIFwic3R5bGVcIixcbiAgICAgICAgICBjYW52YXNTdHlsZSArXG4gICAgICAgICAgICBcIndpZHRoOiAxMDAlOyBtYXJnaW46IDA7IHBhZGRpbmc6IDA7IHVzZXItc2VsZWN0OiBub25lOyAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lOyAtbW96LXVzZXItc2VsZWN0OiBub25lO1wiXG4gICAgICAgICk7XG5cbiAgICAgICAgbGV0IGh0bWxTdHlsZSA9IGh0bWxbMF0uZ2V0QXR0cmlidXRlKFwic3R5bGVcIik7XG4gICAgICAgIGh0bWxbMF0uc2V0QXR0cmlidXRlKFxuICAgICAgICAgIFwic3R5bGVcIixcbiAgICAgICAgICAoaHRtbFN0eWxlID8gaHRtbFN0eWxlIDogXCJcIikgK1xuICAgICAgICAgICAgXCJ1c2VyLXNlbGVjdDogbm9uZTsgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsgLW1vei11c2VyLXNlbGVjdDogbm9uZTtcIlxuICAgICAgICApO1xuICAgICAgfSwgMjAwMCk7XG4gICAgfVxuXG4gICAgLy8gU2V0IFNESyBhcyBsb2FkZWQgdG8gcHJldmVudCByZS1pbml0aWF0aW9uXG4gICAgdGhpcy5pc0xvYWRlZCA9IHRydWU7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHByb2dyZXNzIG9mIGEgZ2FtZS5cbiAgICpcbiAgICogQHBhcmFtIHR5cGUgc3RyaW5nXG4gICAqIEBwYXJhbSBzdGF0ZSBzdHJpbmdcbiAgICogQHBhcmFtIHNjb3JlIG51bWJlclxuICAgKiBAcGFyYW0gbGV2ZWwgbnVtYmVyXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHNldFByb2dyZXNzKHN0YXRlOiBzdHJpbmcsIHNjb3JlOiBudW1iZXIsIGxldmVsOiBudW1iZXIpOiB2b2lkIHtcbiAgICAvLyBTZXQgdGhlIGN1cnJlbnQgcHJvZ3Jlc3NcbiAgICB0aGlzLnByb2dyZXNzID0ge1xuICAgICAgdHlwZTogXCJTREtfUExBWUVSX1NDT1JFX1VQREFURVwiLFxuICAgICAgc3RhdGUsXG4gICAgICBzY29yZSxcbiAgICAgIGxldmVsLFxuICAgICAgY29udGludWVTY29yZTogc2NvcmUsXG4gICAgICBjb250cm9sbGVyOiBcIl9kaWdpdGFwR2FtZVwiLFxuICAgIH07XG5cbiAgICB0aGlzLnNlbmREYXRhKCk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoZSBuZXcgbGV2ZWwgb2YgdGhlIGdhbWUuXG4gICAqXG4gICAqIEBwYXJhbSBsZXZlbCBudW1iZXJcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc2V0TGV2ZWxVcChsZXZlbDogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5wcm9ncmVzcy5sZXZlbCA9IGxldmVsO1xuICAgIHRoaXMucHJvZ3Jlc3MudHlwZSA9IFwiU0RLX1BMQVlFUl9MRVZFTF9VUFwiO1xuXG4gICAgdGhpcy5zZW5kRGF0YSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgZ2FtZSBhcyBmYWlsZWQuXG4gICAqXG4gICAqIEBwYXJhbSBzdGF0ZSBzdHJpbmdcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc2V0UGxheWVyRmFpbGVkKHN0YXRlOiBzdHJpbmcgPSBcIkZBSUxcIik6IHZvaWQge1xuICAgIHRoaXMucHJvZ3Jlc3Muc3RhdGUgPSBzdGF0ZTtcbiAgICB0aGlzLnByb2dyZXNzLnNjb3JlID0gMDtcbiAgICB0aGlzLnByb2dyZXNzLnR5cGUgPSBcIlNES19QTEFZRVJfRkFJTEVEXCI7XG5cbiAgICB0aGlzLnNlbmREYXRhKCk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZHMgZ2FtZSBkYXRhIHRvIHBhcmVudCBwbGF0Zm9ybS5cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIHNlbmREYXRhKCk6IHZvaWQge1xuICAgIC8vIFNlbmQgdGhlIG1lc3NhZ2UgdG8gR2FtZWJveC5cbiAgICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHRoaXMucHJvZ3Jlc3MsIHRoaXMub3JpZ2luKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydCBsaXN0ZW5pbmcgZm9yIG1lc3NhZ2VzXG4gICAqIGZyb20gdGhlIHBsYXRmb3JtLlxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgbGlzdGVuR2FtZWJveEV2ZW50cygpOiB2b2lkIHtcbiAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJtZXNzYWdlXCIsXG4gICAgICBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgRGlnaXRhcEdhbWVQbGF5ZXJTREsuZGVidWcoXCJFdmVudCBSZWNlaXZlZCAtPiAlbyAtPiAlb1wiLCBldmVudC5kYXRhLCBldmVudC5vcmlnaW4pO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICB0eXBlb2YgZXZlbnQuZGF0YSA9PSBcIm9iamVjdFwiICYmXG4gICAgICAgICAgZXZlbnQuZGF0YS5jb250cm9sbGVyICYmXG4gICAgICAgICAgZXZlbnQuZGF0YS5jb250cm9sbGVyID09IFwiX2RpZ2l0YXBBcHBcIlxuICAgICAgICApIHtcbiAgICAgICAgICBsZXQgb3JpZ2luSW5kZXggPSBzZWxmLmFsbG93ZWRPcmlnaW5zLmluZGV4T2YoZXZlbnQub3JpZ2luKTtcblxuICAgICAgICAgIGlmIChvcmlnaW5JbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIERpZ2l0YXBHYW1lUGxheWVyU0RLLmRlYnVnKFwiRXJyb3I6IE9yaWdpbiBub3QgYWxsb3dlZCBpbnNpZGUgZ2FtZSBjb250YWluZXIhXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxmLm9yaWdpbiA9IHNlbGYuYWxsb3dlZE9yaWdpbnNbb3JpZ2luSW5kZXhdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChldmVudC5kYXRhLnR5cGUpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZXZlbnQuZGF0YS50eXBlKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJTREtfU1RBUlRfR0FNRVwiOlxuICAgICAgICAgICAgICAgIHNlbGYuYWZ0ZXJTdGFydEdhbWUoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIFwiU0RLX1BBVVNFX0dBTUVcIjpcbiAgICAgICAgICAgICAgICBzZWxmLmFmdGVyUGF1c2VHYW1lKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSBcIlNES19TVEFSVF9HQU1FX0ZST01fWkVST1wiOlxuICAgICAgICAgICAgICAgIHNlbGYucHJvZ3Jlc3Muc2NvcmUgPSAwO1xuICAgICAgICAgICAgICAgIHNlbGYucHJvZ3Jlc3MubGV2ZWwgPSAwO1xuICAgICAgICAgICAgICAgIHNlbGYucHJvZ3Jlc3MuY29udGludWVTY29yZSA9IDA7XG5cbiAgICAgICAgICAgICAgICBzZWxmLmFmdGVyU3RhcnRHYW1lRnJvbVplcm8oKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIFwiU0RLX0NPTlRJTlVFX1dJVEhfQ1VSUkVOVF9TQ09SRVwiOlxuICAgICAgICAgICAgICAgIHNlbGYucHJvZ3Jlc3Muc2NvcmUgPSBzZWxmLnByb2dyZXNzLmNvbnRpbnVlU2NvcmU7XG5cbiAgICAgICAgICAgICAgICBzZWxmLmFmdGVyQ29udGludWVXaXRoQ3VycmVudFNjb3JlKFxuICAgICAgICAgICAgICAgICAgc2VsZi5wcm9ncmVzcy5zY29yZSxcbiAgICAgICAgICAgICAgICAgIHNlbGYucHJvZ3Jlc3MubGV2ZWxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgRGlnaXRhcEdhbWVQbGF5ZXJTREsuZGVidWcoXG4gICAgICAgICAgICAgICAgICAnRXJyb3I6IGBkYXRhLnR5cGVgID0gXCInICtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuZGF0YS50eXBlICtcbiAgICAgICAgICAgICAgICAgICAgJ1wiIG5vdCBmb3VuZCEgUGxlYXNlIGNoZWNrIGByZWFkbWUubWRgIG9mIGRhdGEgY29sbGVjdG9yIHBhY2thZ2UhJ1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIERpZ2l0YXBHYW1lUGxheWVyU0RLLmRlYnVnKFwiRXJyb3I6IGBldmVudC5kYXRhLnR5cGVgIHNob3VsZCBiZSBpbXBsZW1lbnRlZCFcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZmFsc2VcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IGxpc3RlbmluZyBmb3IgbWVzc2FnZXNcbiAgICogZnJvbSB0aGUgU3RyZWFtciBwbGF0Zm9ybS5cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGxpc3RlblN0cmVhbXJFdmVudHMoKTogdm9pZCB7XG4gICAgbGV0IGNhbnZhczogQ2FudmFzRWxlbWVudCA9IG51bGw7XG4gICAgbGV0IHN0cmVhbTogYW55ID0gbnVsbDtcbiAgICBsZXQgY29ubmVjdGlvbjogYW55ID0gbnVsbDtcbiAgICBsZXQgY2hhbm5lbDogYW55ID0gbnVsbDtcbiAgICBsZXQgaWNlQ2FuZGlkYXRlOiBhbnkgPSBudWxsO1xuICAgIGxldCBjb25uZWN0ZWQgPSBmYWxzZTtcbiAgICBsZXQgaXNOZWdvdGlhdGlvbk5lZWRlZCA9IGZhbHNlO1xuXG4gICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuZGVidWcoXCJJbml0IFN0cmVhbXIgdjEuMC44XCIpO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGFzeW5jIChldmVudCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgRGlnaXRhcEdhbWVQbGF5ZXJTREsuZGVidWcoXCJTdHJlYW1yIEV2ZW50IHJlY2VpdmVkXCIsIGV2ZW50LmRhdGEpO1xuXG4gICAgICAgIGlmICghZXZlbnQuZGF0YSB8fCB0eXBlb2YgZXZlbnQuZGF0YSAhPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHsgY29udHJvbGxlciwgdHlwZSwgYWN0aW9uLCBvZmZlciwgdG91cm5hbWVudF9pZCwgdXNlcm5hbWUgfSA9XG4gICAgICAgICAgZXZlbnQuZGF0YTtcblxuICAgICAgICBEaWdpdGFwR2FtZVBsYXllclNESy5kZWJ1ZyhcbiAgICAgICAgICBcIlN0cmVhbXIgRXZlbnQgZGV0YWlsczogXCIsXG4gICAgICAgICAgY29udHJvbGxlcixcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIGFjdGlvbixcbiAgICAgICAgICBvZmZlcixcbiAgICAgICAgICB0b3VybmFtZW50X2lkLFxuICAgICAgICAgIHVzZXJuYW1lXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKGNvbnRyb2xsZXIgIT09IFwiX2RpZ2l0YXBBcHBcIiAmJiB0eXBlICE9PSBcIndlYnJ0Y1wiKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgKCFjb25uZWN0ZWQpIHtcbiAgICAgICAgLy8gICBjYW52YXMgPSA8Q2FudmFzRWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiY2FudmFzXCIpO1xuICAgICAgICAvLyAgIHN0cmVhbSA9IGNhbnZhcy5jYXB0dXJlU3RyZWFtKDMwKTtcbiAgICAgICAgLy8gICBjb25uZWN0aW9uID0gbmV3IFJUQ1BlZXJDb25uZWN0aW9uKHtcbiAgICAgICAgLy8gICAgIGljZVNlcnZlcnM6IFt7IHVybHM6IFwic3R1bjpzdHVuLmwuZ29vZ2xlLmNvbToxOTMwMlwiIH1dLFxuICAgICAgICAvLyAgIH0pO1xuICAgICAgICAvLyAgIGNoYW5uZWwgPSBjb25uZWN0aW9uLmNyZWF0ZURhdGFDaGFubmVsKFxuICAgICAgICAvLyAgICAgYHN0cmVhbXItJHt0b3VybmFtZW50X2lkfS0ke3VzZXJuYW1lfWAsXG4gICAgICAgIC8vICAgICB7XG4gICAgICAgIC8vICAgICAgIG5lZ290aWF0ZWQ6IHRydWUsXG4gICAgICAgIC8vICAgICAgIGlkOiAwLFxuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyAgICk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICAvLyBpZiAoYWN0aW9uID09PSBcImNsb3NlXCIpIHtcbiAgICAgICAgLy8gICBmb3IgKGxldCBzZW5kZXIgb2YgY29ubmVjdGlvbi5nZXRTZW5kZXJzKCkpIHtcbiAgICAgICAgLy8gICAgIGNvbm5lY3Rpb24ucmVtb3ZlVHJhY2soc2VuZGVyKTtcbiAgICAgICAgLy8gICB9XG5cbiAgICAgICAgLy8gICBjYW52YXMgPSBudWxsO1xuICAgICAgICAvLyAgIHN0cmVhbSA9IG51bGw7XG5cbiAgICAgICAgLy8gICBjaGFubmVsLnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiBcInN0cmVhbXJcIiwgYWN0aW9uOiBcImNsb3NlXCIgfSkpO1xuICAgICAgICAvLyAgIGNvbm5lY3Rpb24uY2xvc2UoKTtcblxuICAgICAgICAvLyAgIGNvbm5lY3Rpb24gPSBudWxsO1xuICAgICAgICAvLyAgIGNoYW5uZWwgPSBudWxsO1xuICAgICAgICAvLyAgIGljZUNhbmRpZGF0ZSA9IG51bGw7XG4gICAgICAgIC8vICAgY29ubmVjdGVkID0gZmFsc2U7XG4gICAgICAgIC8vICAgaXNOZWdvdGlhdGlvbk5lZWRlZCA9IGZhbHNlO1xuICAgICAgICAvLyAgIHJldHVybjtcbiAgICAgICAgLy8gfVxuXG4gICAgICAgIC8vIGlmIChhY3Rpb24gPT09IFwiaW5pdFwiKSB7XG4gICAgICAgIC8vICAgZm9yIChjb25zdCB0cmFjayBvZiBzdHJlYW0uZ2V0VHJhY2tzKCkpIHtcbiAgICAgICAgLy8gICAgIGNvbm5lY3Rpb24uYWRkVHJhY2sodHJhY2ssIHN0cmVhbSk7XG4gICAgICAgIC8vICAgfVxuXG4gICAgICAgIC8vICAgY29uc3Qgb25Db25uZWN0aW9uU3RhdGVDaGFuZ2UgPSAoZTogYW55KSA9PiB7XG4gICAgICAgIC8vICAgICBzZWxmLmRlYnVnKFxuICAgICAgICAvLyAgICAgICBcIl9fV0VCUlRDLm9uQ29ubmVjdGlvblN0YXRlQ2hhbmdlX19cIixcbiAgICAgICAgLy8gICAgICAgY29ubmVjdGlvbi5jb25uZWN0aW9uU3RhdGVcbiAgICAgICAgLy8gICAgICk7XG4gICAgICAgIC8vICAgICBzd2l0Y2ggKGNvbm5lY3Rpb24uY29ubmVjdGlvblN0YXRlKSB7XG4gICAgICAgIC8vICAgICAgIGNhc2UgXCJjb25uZWN0ZWRcIjpcbiAgICAgICAgLy8gICAgICAgICBjb25uZWN0ZWQgPSB0cnVlO1xuXG4gICAgICAgIC8vICAgICAgICAgKDxXaW5kb3c+ZXZlbnQuc291cmNlKS5wb3N0TWVzc2FnZShcbiAgICAgICAgLy8gICAgICAgICAgIHsgdHlwZTogXCJzdHJlYW1yXCIsIGFjdGlvbjogXCJjb25uZWN0ZWRcIiB9LFxuICAgICAgICAvLyAgICAgICAgICAgZXZlbnQub3JpZ2luXG4gICAgICAgIC8vICAgICAgICAgKTtcbiAgICAgICAgLy8gICAgICAgICBicmVhaztcbiAgICAgICAgLy8gICAgICAgY2FzZSBcImRpc2Nvbm5lY3RlZFwiOlxuICAgICAgICAvLyAgICAgICAgIGZvciAobGV0IHNlbmRlciBvZiBjb25uZWN0aW9uLmdldFNlbmRlcnMoKSkge1xuICAgICAgICAvLyAgICAgICAgICAgY29ubmVjdGlvbi5yZW1vdmVUcmFjayhzZW5kZXIpO1xuICAgICAgICAvLyAgICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgICBjYW52YXMgPSBudWxsO1xuICAgICAgICAvLyAgICAgICAgIHN0cmVhbSA9IG51bGw7XG5cbiAgICAgICAgLy8gICAgICAgICAoPFdpbmRvdz5ldmVudC5zb3VyY2UpLnBvc3RNZXNzYWdlKFxuICAgICAgICAvLyAgICAgICAgICAgeyB0eXBlOiBcInN0cmVhbXJcIiwgYWN0aW9uOiBcImRpc2Nvbm5lY3RlZFwiIH0sXG4gICAgICAgIC8vICAgICAgICAgICBldmVudC5vcmlnaW5cbiAgICAgICAgLy8gICAgICAgICApO1xuXG4gICAgICAgIC8vICAgICAgICAgY2hhbm5lbC5jbG9zZSgpO1xuICAgICAgICAvLyAgICAgICAgIGNvbm5lY3Rpb24uY2xvc2UoKTtcbiAgICAgICAgLy8gICAgICAgICBjb25uZWN0aW9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgIC8vICAgICAgICAgICBcImNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLFxuICAgICAgICAvLyAgICAgICAgICAgb25Db25uZWN0aW9uU3RhdGVDaGFuZ2VcbiAgICAgICAgLy8gICAgICAgICApO1xuICAgICAgICAvLyAgICAgICAgIGNvbm5lY3Rpb24ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgLy8gICAgICAgICAgIFwiaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXCIsXG4gICAgICAgIC8vICAgICAgICAgICBvbkljZUNvbm5lY3Rpb25TdGF0ZUNoYW5nZVxuICAgICAgICAvLyAgICAgICAgICk7XG4gICAgICAgIC8vICAgICAgICAgY29ubmVjdGlvbi5yZW1vdmVFdmVudExpc3RlbmVyKFwiaWNlY2FuZGlkYXRlXCIsIG9uSWNlQ2FuZGlkYXRlKTtcbiAgICAgICAgLy8gICAgICAgICBjb25uZWN0aW9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgIC8vICAgICAgICAgICBcIm9ubmVnb3RpYXRpb25uZWVkZWRcIixcbiAgICAgICAgLy8gICAgICAgICAgIG9uTmVnb3RpYXRpb25OZWVkZWRcbiAgICAgICAgLy8gICAgICAgICApO1xuICAgICAgICAvLyAgICAgICAgIGNvbm5lY3Rpb24ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgLy8gICAgICAgICAgIFwib25zaWduYWxpbmdzdGF0ZWNoYW5nZVwiLFxuICAgICAgICAvLyAgICAgICAgICAgb25TaWduYWxpbmdTdGF0ZUNoYW5nZVxuICAgICAgICAvLyAgICAgICAgICk7XG4gICAgICAgIC8vICAgICAgICAgY2hhbm5lbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBvbk1lc3NhZ2UpO1xuXG4gICAgICAgIC8vICAgICAgICAgY29ubmVjdGlvbiA9IG51bGw7XG4gICAgICAgIC8vICAgICAgICAgY2hhbm5lbCA9IG51bGw7XG4gICAgICAgIC8vICAgICAgICAgaWNlQ2FuZGlkYXRlID0gbnVsbDtcbiAgICAgICAgLy8gICAgICAgICBjb25uZWN0ZWQgPSBmYWxzZTtcblxuICAgICAgICAvLyAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyAgIH07XG5cbiAgICAgICAgLy8gICBjb25zdCBvbkljZUNvbm5lY3Rpb25TdGF0ZUNoYW5nZSA9IChldmVudDogYW55KSA9PiB7XG4gICAgICAgIC8vICAgICBzZWxmLmRlYnVnKFxuICAgICAgICAvLyAgICAgICBcIl9fV0VCUlRDLm9uSUNFQ29ubmVjdGlvblN0YXRlQ2hhbmdlX19cIixcbiAgICAgICAgLy8gICAgICAgY29ubmVjdGlvbi5pY2VDb25uZWN0aW9uU3RhdGVcbiAgICAgICAgLy8gICAgICk7XG4gICAgICAgIC8vICAgICBzd2l0Y2ggKGNvbm5lY3Rpb24uaWNlQ29ubmVjdGlvblN0YXRlKSB7XG4gICAgICAgIC8vICAgICAgIGNhc2UgXCJjb25uZWN0ZWRcIjpcbiAgICAgICAgLy8gICAgICAgICBicmVhaztcbiAgICAgICAgLy8gICAgICAgY2FzZSBcImRpc2Nvbm5lY3RlZFwiOlxuICAgICAgICAvLyAgICAgICBjYXNlIFwiZmFpbGVkXCI6XG4gICAgICAgIC8vICAgICAgICAgY29ubmVjdGlvbi5yZXN0YXJ0SWNlKCk7XG4gICAgICAgIC8vICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vICAgfTtcblxuICAgICAgICAvLyAgIGNvbnN0IG9uSWNlQ2FuZGlkYXRlID0gKGU6IGFueSkgPT4ge1xuICAgICAgICAvLyAgICAgdHJ5IHtcbiAgICAgICAgLy8gICAgICAgc2VsZi5kZWJ1ZyhcIl9fV0VCUlRDLm9uSUNFQ2FuZGlkYXRlX19cIiwgZS5jYW5kaWRhdGUpO1xuXG4gICAgICAgIC8vICAgICAgIGlmIChlLmNhbmRpZGF0ZSkge1xuICAgICAgICAvLyAgICAgICAgIGljZUNhbmRpZGF0ZSA9IGUuY2FuZGlkYXRlO1xuICAgICAgICAvLyAgICAgICB9IGVsc2Uge1xuICAgICAgICAvLyAgICAgICAgIHNlbGYuZGVidWcoXG4gICAgICAgIC8vICAgICAgICAgICBcIl9fV0VCUlRDLmxvY2FsRGVzY3JpcHRpb25fX1wiLFxuICAgICAgICAvLyAgICAgICAgICAgY29ubmVjdGlvbi5sb2NhbERlc2NyaXB0aW9uXG4gICAgICAgIC8vICAgICAgICAgKTtcblxuICAgICAgICAvLyAgICAgICAgICg8V2luZG93PmV2ZW50LnNvdXJjZSkucG9zdE1lc3NhZ2UoXG4gICAgICAgIC8vICAgICAgICAgICB7XG4gICAgICAgIC8vICAgICAgICAgICAgIHR5cGU6IFwic3RyZWFtclwiLFxuICAgICAgICAvLyAgICAgICAgICAgICBhY3Rpb246IFwiYW5zd2VyXCIsXG4gICAgICAgIC8vICAgICAgICAgICAgIG9mZmVyOiB3aW5kb3cuYnRvYShcbiAgICAgICAgLy8gICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShjb25uZWN0aW9uLmxvY2FsRGVzY3JpcHRpb24pXG4gICAgICAgIC8vICAgICAgICAgICAgICksXG4gICAgICAgIC8vICAgICAgICAgICB9LFxuICAgICAgICAvLyAgICAgICAgICAgZXZlbnQub3JpZ2luXG4gICAgICAgIC8vICAgICAgICAgKTtcbiAgICAgICAgLy8gICAgICAgfVxuICAgICAgICAvLyAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vICAgICAgIGNvbnNvbGUuZXJyb3IoXCJfX1dFQlJUQy5vbklDRUNhbmRpZGF0ZV9fXCIsIGVyci5tZXNzYWdlKTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gICB9O1xuXG4gICAgICAgIC8vICAgY29uc3Qgb25NZXNzYWdlID0gYXN5bmMgKGV2ZW50OiBhbnkpID0+IHtcbiAgICAgICAgLy8gICAgIHRyeSB7XG4gICAgICAgIC8vICAgICAgIGlmICghZXZlbnQuZGF0YSkge1xuICAgICAgICAvLyAgICAgICAgIHJldHVybjtcbiAgICAgICAgLy8gICAgICAgfVxuXG4gICAgICAgIC8vICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpO1xuXG4gICAgICAgIC8vICAgICAgIGlmIChtZXNzYWdlLmljZUNhbmRpZGF0ZSkge1xuICAgICAgICAvLyAgICAgICAgIGF3YWl0IGNvbm5lY3Rpb24uYWRkSWNlQ2FuZGlkYXRlKG1lc3NhZ2UuaWNlQ2FuZGlkYXRlKTtcbiAgICAgICAgLy8gICAgICAgICBjaGFubmVsLnNlbmQoSlNPTi5zdHJpbmdpZnkoeyBpY2VDYW5kaWRhdGUgfSkpO1xuICAgICAgICAvLyAgICAgICB9XG4gICAgICAgIC8vICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gICAgICAgY29uc29sZS5lcnJvcihcIl9fV0VCUlRDLm9uTWVzc2FnZV9fXCIsIGVyci5tZXNzYWdlKTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gICB9O1xuXG4gICAgICAgIC8vICAgY29uc3Qgb25OZWdvdGlhdGlvbk5lZWRlZCA9IGFzeW5jIChldmVudDogYW55KSA9PiB7XG4gICAgICAgIC8vICAgICB0cnkge1xuICAgICAgICAvLyAgICAgICBpZiAoaXNOZWdvdGlhdGlvbk5lZWRlZCkge1xuICAgICAgICAvLyAgICAgICAgIHJldHVybjtcbiAgICAgICAgLy8gICAgICAgfVxuXG4gICAgICAgIC8vICAgICAgIGF3YWl0IGNvbm5lY3Rpb24uc2V0UmVtb3RlRGVzY3JpcHRpb24oSlNPTi5wYXJzZShvZmZlcikpO1xuICAgICAgICAvLyAgICAgICBhd2FpdCBjb25uZWN0aW9uLnNldExvY2FsRGVzY3JpcHRpb24oXG4gICAgICAgIC8vICAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5jcmVhdGVBbnN3ZXIoKVxuICAgICAgICAvLyAgICAgICApO1xuICAgICAgICAvLyAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vICAgICAgIGNvbnNvbGUuZXJyb3IoXCJfX1dFQlJUQy5vbk5lZ290aWF0aW9uTmVlZGVkXCIsIGVyci5tZXNzYWdlKTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gICB9O1xuXG4gICAgICAgIC8vICAgY29uc3Qgb25TaWduYWxpbmdTdGF0ZUNoYW5nZSA9IChlOiBhbnkpID0+XG4gICAgICAgIC8vICAgICAoaXNOZWdvdGlhdGlvbk5lZWRlZCA9IGNvbm5lY3Rpb24uc2lnbmFsaW5nU3RhdGUgIT09IFwic3RhYmxlXCIpO1xuXG4gICAgICAgIC8vICAgY29ubmVjdGlvbi5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAvLyAgICAgXCJjb25uZWN0aW9uc3RhdGVjaGFuZ2VcIixcbiAgICAgICAgLy8gICAgIG9uQ29ubmVjdGlvblN0YXRlQ2hhbmdlXG4gICAgICAgIC8vICAgKTtcbiAgICAgICAgLy8gICBjb25uZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgIC8vICAgICBcImljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLFxuICAgICAgICAvLyAgICAgb25JY2VDb25uZWN0aW9uU3RhdGVDaGFuZ2VcbiAgICAgICAgLy8gICApO1xuICAgICAgICAvLyAgIGNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcihcImljZWNhbmRpZGF0ZVwiLCBvbkljZUNhbmRpZGF0ZSk7XG4gICAgICAgIC8vICAgY29ubmVjdGlvbi5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAvLyAgICAgXCJvbm5lZ290aWF0aW9ubmVlZGVkXCIsXG4gICAgICAgIC8vICAgICBvbk5lZ290aWF0aW9uTmVlZGVkXG4gICAgICAgIC8vICAgKTtcbiAgICAgICAgLy8gICBjb25uZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgIC8vICAgICBcIm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2VcIixcbiAgICAgICAgLy8gICAgIG9uU2lnbmFsaW5nU3RhdGVDaGFuZ2VcbiAgICAgICAgLy8gICApO1xuICAgICAgICAvLyAgIGNoYW5uZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgb25NZXNzYWdlKTtcblxuICAgICAgICAvLyAgIGF3YWl0IGNvbm5lY3Rpb24uc2V0UmVtb3RlRGVzY3JpcHRpb24oSlNPTi5wYXJzZShvZmZlcikpO1xuICAgICAgICAvLyAgIGF3YWl0IGNvbm5lY3Rpb24uc2V0TG9jYWxEZXNjcmlwdGlvbihhd2FpdCBjb25uZWN0aW9uLmNyZWF0ZUFuc3dlcigpKTtcbiAgICAgICAgLy8gfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHNlbGYuZGVidWcoXCJfX1dFQlJUQ19fXCIsIGVyci5tZXNzYWdlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbXB0eSBtZXRob2RzIGZvciBnYW1lIGRldmVsb3BlciB0byB1c2UuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGFmdGVyU3RhcnRHYW1lRnJvbVplcm8oKSB7fVxuXG4gIHB1YmxpYyBzdGF0aWMgYWZ0ZXJDb250aW51ZVdpdGhDdXJyZW50U2NvcmUoc2NvcmU6IG51bWJlciwgbGV2ZWw6IG51bWJlcikge31cblxuICBwdWJsaWMgc3RhdGljIGFmdGVyU3RhcnRHYW1lKCkge31cblxuICBwdWJsaWMgc3RhdGljIGFmdGVyUGF1c2VHYW1lKCkge31cblxuICAvKipcbiAgICogSWYgdXNlciBpcyBkZWJ1Z2dpbmcsIHNob3cgc29tZSBjb25zb2xlIGxvZ3MuXG4gICAqXG4gICAqIEBwYXJhbSBtZXNzYWdlIGFueVxuICAgKiBAcGFyYW0gcGFyYW1zIGFueVtdXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBkZWJ1ZyhtZXNzYWdlPzogYW55LCAuLi5wYXJhbXM6IGFueVtdKTogdm9pZCB7XG4gICAgY29uc3QgcGFyZW50V2luZG93OiBhbnkgPSB3aW5kb3c7XG5cbiAgICAvLyBpZiAocGFyZW50V2luZG93LnNka2RlYnVnKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkRpZ2l0YXBHYW1lUGxheWVyU0RLIC0+IFwiICsgbWVzc2FnZSwgLi4ucGFyYW1zKTtcbiAgICAvLyB9XG4gIH1cbn1cblxuLy8gUmVhZCB0aGUgY3VycmVudCBxdWV1ZVxuaWYgKHR5cGVvZiAoPGFueT53aW5kb3cpLmRpZ2l0YXBTREsgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgbGV0IG9sZFF1ZXVlID0gKDxhbnk+d2luZG93KS5kaWdpdGFwU0RLLnE7XG4gIERpZ2l0YXBHYW1lUGxheWVyU0RLLnByb2Nlc3NPbGRRdWV1ZShvbGRRdWV1ZSk7XG59XG5cbi8vIFdhdGNoIHRoZSBxdWV1ZSB3aXRoIG5ldyBtZXRob2Rcbig8YW55PndpbmRvdykuZGlnaXRhcFNESyA9IERpZ2l0YXBHYW1lUGxheWVyU0RLLnByb2Nlc3NRdWV1ZTtcblxuLy8gRm9yY2UgdGhlIGxvZ3MgdG8gYmUgaGlkZGVuXG5jb25zdCBsb2cgPSB3aW5kb3cuY29uc29sZS5sb2c7XG53aW5kb3cuY29uc29sZS5sb2cgPSBmdW5jdGlvbiAoLi4uYXJnczogYW55KSB7XG4gIHJldHVybiB0cnVlO1xufTtcbiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxuX193ZWJwYWNrX21vZHVsZXNfX1s2MDddKCk7XG4iXSwic291cmNlUm9vdCI6IiJ9