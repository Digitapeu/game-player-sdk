({607:function(){var e=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),s=0;for(t=0;t<o;t++)for(var a=arguments[t],n=0,i=a.length;n<i;n++,s++)r[s]=a[n];return r},t=function(){function t(){}return t.processQueue=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];t.debug("Processing Queue ->",e),"string"==typeof e[0]&&t[e[0]].apply(t,e.slice(1))},t.processOldQueue=function(e){var t=this;e.forEach((function(e){t.processQueue.apply(t,e)}))},t.setCallback=function(e,t){this[e]=t},t.init=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this.debug("SDK Initialization");var o=["score","highScore",e,t];if(!this.isLoaded){window.parent.postMessage({controller:"_digitapGame",type:"SDK_SETTINGS",ui:o,ready:!0},"*"),this.listenGameboxEvents();var r=document.getElementsByTagName("canvas"),s=document.getElementsByTagName("html");setTimeout((function(){var e=r[0].getAttribute("style");r[0].setAttribute("style",e+"width: 100%; margin: 0; padding: 0; user-select: none; -webkit-user-select: none; -moz-user-select: none;");var t=s[0].getAttribute("style");s[0].setAttribute("style",(t||"")+"user-select: none; -webkit-user-select: none; -moz-user-select: none;")}),2e3)}this.isLoaded=!0},t.setProgress=function(e,t,o){this.progress={type:"SDK_PLAYER_SCORE_UPDATE",state:e,score:t,level:o,continueScore:t,controller:"_digitapGame"},this.sendData()},t.setLevelUp=function(e){this.progress.level=e,this.progress.type="SDK_PLAYER_LEVEL_UP",this.sendData()},t.setPlayerFailed=function(e){void 0===e&&(e="FAIL"),this.progress.state=e,this.progress.score=0,this.progress.type="SDK_PLAYER_FAILED",this.sendData()},t.sendData=function(){window.parent.postMessage(this.progress,this.origin)},t.listenGameboxEvents=function(){var e=this;window.addEventListener("message",(function(t){if(e.debug("Event Received -> %o -> %o",t.data,t.origin),"object"==typeof t.data&&t.data.controller&&"_digitapApp"==t.data.controller){var o=e.allowedOrigins.indexOf(t.origin);if(-1===o)return void e.debug("Error: Origin not allowed inside game container!");if(e.origin=e.allowedOrigins[o],t.data.type)switch(t.data.type){case"SDK_START_GAME":e.afterStartGame();break;case"SDK_PAUSE_GAME":e.afterPauseGame();break;case"SDK_START_GAME_FROM_ZERO":e.progress.score=0,e.progress.level=0,e.progress.continueScore=0,e.afterStartGameFromZero();break;case"SDK_CONTINUE_WITH_CURRENT_SCORE":e.progress.score=e.progress.continueScore,e.afterContinueWithCurrentScore(e.progress.score,e.progress.level);break;default:e.debug('Error: `data.type` = "'+t.data.type+'" not found! Please check `readme.md` of data collector package!')}else e.debug("Error: `event.data.type` should be implemented!")}}),!1)},t.afterStartGameFromZero=function(){},t.afterContinueWithCurrentScore=function(e,t){},t.afterStartGame=function(){},t.afterPauseGame=function(){},t.debug=function(t){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];var s=window;s.sdkdebug&&console.log.apply(console,e(["DigitapGamePlayerSDK -> "+t],o))},t.gameObject=null,t.isLoaded=!1,t.origin=null,t.isDebugging=!1,t.allowedOrigins=["https://build.digitap.dev","https://wam.app","https://app.wam.app","https://wam.eu","https://play.wam.app","https://stage.wam.app","http://localhost:63342","http://localhost:8080","http://localhost:3000","http://localhost:3001","https://localhost:3001","http://127.0.0.1:3001","https://127.0.0.1:3001"],t.progress={controller:"_digitapGame",type:"SDK_PLAYER_SCORE_UPDATE",score:0,level:0,state:null,continueScore:0},t}();if(void 0!==window.digitapSDK){var o=window.digitapSDK.q;t.processOldQueue(o)}window.digitapSDK=t.processQueue,window.console.log,window.console.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!0}}})[607]();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nYW1lLXBsYXllci1zZGsvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vZ2FtZS1wbGF5ZXItc2RrL3dlYnBhY2svc3RhcnR1cCJdLCJuYW1lcyI6WyJwcm9jZXNzUXVldWUiLCJEaWdpdGFwR2FtZVBsYXllclNESyIsImRlYnVnIiwiYXJncyIsImFwcGx5Iiwic2xpY2UiLCJwcm9jZXNzT2xkUXVldWUiLCJxdWV1ZSIsImZvckVhY2giLCJzZXRDYWxsYmFjayIsImZuIiwiY2FsbGJhY2siLCJ0aGlzIiwiaW5pdCIsImhhc1Njb3JlIiwiaGFzSGlnaFNjb3JlIiwidWlPcHRpb25zIiwiaXNMb2FkZWQiLCJ3aW5kb3ciLCJwYXJlbnQiLCJwb3N0TWVzc2FnZSIsImNvbnRyb2xsZXIiLCJ0eXBlIiwidWkiLCJyZWFkeSIsImxpc3RlbkdhbWVib3hFdmVudHMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwic2V0VGltZW91dCIsImNhbnZhc1N0eWxlIiwiZ2V0QXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwiaHRtbFN0eWxlIiwic2V0UHJvZ3Jlc3MiLCJzdGF0ZSIsInNjb3JlIiwibGV2ZWwiLCJwcm9ncmVzcyIsImNvbnRpbnVlU2NvcmUiLCJzZW5kRGF0YSIsInNldExldmVsVXAiLCJzZXRQbGF5ZXJGYWlsZWQiLCJvcmlnaW4iLCJzZWxmIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiZGF0YSIsIm9yaWdpbkluZGV4IiwiYWxsb3dlZE9yaWdpbnMiLCJpbmRleE9mIiwiYWZ0ZXJTdGFydEdhbWUiLCJhZnRlclBhdXNlR2FtZSIsImFmdGVyU3RhcnRHYW1lRnJvbVplcm8iLCJhZnRlckNvbnRpbnVlV2l0aEN1cnJlbnRTY29yZSIsIm1lc3NhZ2UiLCJwYXJlbnRXaW5kb3ciLCJzZGtkZWJ1ZyIsImNvbnNvbGUiLCJsb2ciLCJwYXJhbXMiLCJnYW1lT2JqZWN0IiwiaXNEZWJ1Z2dpbmciLCJkaWdpdGFwU0RLIiwi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QUFLekMsTUFDSCx5QkFDRTJDLEVBQU1DLEtBQUt4QixLQUNYLHlFQUtScUIsRUFBS3pDLE1BQU0sdURBSWpCLElBeVBVLEVBQUFrRCx1QkFBZCxhQUVjLEVBQUFDLDhCQUFkLFNBQTRDbEIsRUFBZUMsS0FFN0MsRUFBQWMsZUFBZCxhQUVjLEVBQUFDLGVBQWQsYUFRZSxFQUFBakQsTUFBZixTQUFxQm9ELEcsSUFBZSx3REFDbEMsSUFBTUMsRUFBb0JyQyxPQUV0QnFDLEVBQWFDLFVBQ2ZDLFFBQVFDLElBQUcsTUFBWEQsUUFBTyxHQUFLLDJCQUE2QkgsR0FBWUssS0E5Z0IzQyxFQUFBQyxXQUFrQixLQUNqQixFQUFBM0MsVUFBb0IsRUFDcEIsRUFBQXlCLE9BQWlCLEtBQ2pCLEVBQUFtQixhQUF1QixFQUV2QixFQUFBYixlQUEyQixDQUN4Qyw0QkFDQSxrQkFDQSxzQkFDQSxpQkFDQSx1QkFDQSx3QkFDQSx5QkFDQSx3QkFDQSx3QkFDQSx3QkFDQSx5QkFDQSx3QkFDQSwwQkFHYSxFQUFBWCxTQUFxQixDQUNsQ2hCLFdBQVksZUFDWkMsS0FBTSwwQkFDTmEsTUFBTyxFQUNQQyxNQUFPLEVBQ1BGLE1BQU8sS0FDUEksY0FBZSxHQXNmbkIsRUFsaEJBLEdBcWhCQSxRQUF3QyxJQUF2QnBCLE9BQVE0QyxXQUE0QixDQUNuRCxJQUFJQyxFQUFpQjdDLE9BQVE0QyxXQUFXRSxFQUN4Qy9ELEVBQXFCSyxnQkFBZ0J5RCxHQUlqQzdDLE9BQVE0QyxXQUFhN0QsRUFBcUJELGFBR3BDa0IsT0FBT3VDLFFBQVFDLElBQzNCeEMsT0FBT3VDLFFBQVFDLElBQU0sVyxJQUFVLHNEQUM3QixPQUFPLE1DMWlCVyIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInR5cGUgUHJvZ3Jlc3MgPSB7XG4gIGNvbnRyb2xsZXI6IHN0cmluZztcbiAgdHlwZTogc3RyaW5nO1xuICBzY29yZTogbnVtYmVyO1xuICBsZXZlbDogbnVtYmVyO1xuICBzdGF0ZTogYW55O1xuICBjb250aW51ZVNjb3JlOiBudW1iZXI7XG59O1xuXG5pbnRlcmZhY2UgQ2FudmFzRWxlbWVudCBleHRlbmRzIEhUTUxDYW52YXNFbGVtZW50IHtcbiAgY2FwdHVyZVN0cmVhbShmcmFtZVJhdGU/OiBudW1iZXIpOiBNZWRpYVN0cmVhbTtcbn1cblxuY2xhc3MgRGlnaXRhcEdhbWVQbGF5ZXJTREsge1xuICBwdWJsaWMgc3RhdGljIGdhbWVPYmplY3Q6IGFueSA9IG51bGw7XG4gIHByaXZhdGUgc3RhdGljIGlzTG9hZGVkOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgc3RhdGljIG9yaWdpbjogc3RyaW5nID0gbnVsbDtcbiAgcHJpdmF0ZSBzdGF0aWMgaXNEZWJ1Z2dpbmc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBwcml2YXRlIHN0YXRpYyBhbGxvd2VkT3JpZ2luczogc3RyaW5nW10gPSBbXG4gICAgXCJodHRwczovL2J1aWxkLmRpZ2l0YXAuZGV2XCIsXG4gICAgXCJodHRwczovL3dhbS5hcHBcIixcbiAgICBcImh0dHBzOi8vYXBwLndhbS5hcHBcIixcbiAgICBcImh0dHBzOi8vd2FtLmV1XCIsXG4gICAgXCJodHRwczovL3BsYXkud2FtLmFwcFwiLFxuICAgIFwiaHR0cHM6Ly9zdGFnZS53YW0uYXBwXCIsXG4gICAgXCJodHRwOi8vbG9jYWxob3N0OjYzMzQyXCIsXG4gICAgXCJodHRwOi8vbG9jYWxob3N0OjgwODBcIixcbiAgICBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiLFxuICAgIFwiaHR0cDovL2xvY2FsaG9zdDozMDAxXCIsXG4gICAgXCJodHRwczovL2xvY2FsaG9zdDozMDAxXCIsXG4gICAgXCJodHRwOi8vMTI3LjAuMC4xOjMwMDFcIixcbiAgICBcImh0dHBzOi8vMTI3LjAuMC4xOjMwMDFcIixcbiAgXTtcblxuICBwcml2YXRlIHN0YXRpYyBwcm9ncmVzczogUHJvZ3Jlc3MgPSB7XG4gICAgY29udHJvbGxlcjogXCJfZGlnaXRhcEdhbWVcIixcbiAgICB0eXBlOiBcIlNES19QTEFZRVJfU0NPUkVfVVBEQVRFXCIsXG4gICAgc2NvcmU6IDAsXG4gICAgbGV2ZWw6IDAsXG4gICAgc3RhdGU6IG51bGwsXG4gICAgY29udGludWVTY29yZTogMCxcbiAgfTtcblxuICAvKipcbiAgICogQ2FsbCBhIG1ldGhvZCBmcm9tIHRoZSBjbGFzcyxcbiAgICogdGhyb3VnaCBhIHF1ZXVlLlxuICAgKlxuICAgKiBAcGFyYW0gYXJncyBhcnJheVxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBwcm9jZXNzUXVldWUoLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICBEaWdpdGFwR2FtZVBsYXllclNESy5kZWJ1ZyhcIlByb2Nlc3NpbmcgUXVldWUgLT5cIiwgYXJncyk7XG5cbiAgICBpZiAodHlwZW9mIGFyZ3NbMF0gPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIERpZ2l0YXBHYW1lUGxheWVyU0RLW1xuICAgICAgICBhcmdzWzBdIGFzXG4gICAgICAgICAgfCBcImluaXRcIlxuICAgICAgICAgIHwgXCJzZXRQcm9ncmVzc1wiXG4gICAgICAgICAgfCBcInNldExldmVsVXBcIlxuICAgICAgICAgIHwgXCJzZXRQbGF5ZXJGYWlsZWRcIlxuICAgICAgICAgIHwgXCJzZXRDYWxsYmFja1wiXG4gICAgICBdLmFwcGx5KERpZ2l0YXBHYW1lUGxheWVyU0RLLCBhcmdzLnNsaWNlKDEpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUHJvY2VzcyBhIGN1cnJlbnQgcXVldWUuXG4gICAqXG4gICAqIEBwYXJhbSBxdWV1ZSBhcnJheVxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBwcm9jZXNzT2xkUXVldWUocXVldWU6IFtdKTogdm9pZCB7XG4gICAgcXVldWUuZm9yRWFjaCgoYXJnczogYW55KSA9PiB7XG4gICAgICB0aGlzLnByb2Nlc3NRdWV1ZSguLi5hcmdzKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIGEgY2FsbGJhY2sgbWV0aG9kLlxuICAgKlxuICAgKiBAcGFyYW0gZm4gc3RyaW5nXG4gICAqIEBwYXJhbSBjYWxsYmFjayBmdW5jdGlvblxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBzZXRDYWxsYmFjayhcbiAgICBmbjpcbiAgICAgIHwgXCJhZnRlclN0YXJ0R2FtZUZyb21aZXJvXCJcbiAgICAgIHwgXCJhZnRlckNvbnRpbnVlV2l0aEN1cnJlbnRTY29yZVwiXG4gICAgICB8IFwiYWZ0ZXJTdGFydEdhbWVcIlxuICAgICAgfCBcImFmdGVyUGF1c2VHYW1lXCIsXG4gICAgY2FsbGJhY2s6IGFueVxuICApOiB2b2lkIHtcbiAgICB0aGlzW2ZuXSA9IGNhbGxiYWNrO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXQgYSBuZXcgZ2FtZSBjb25uZWN0aW9uIHdpdGhcbiAgICogdGhlIHBhcmVudCBwbGF0Zm9ybS5cbiAgICpcbiAgICogQHBhcmFtIHVpT3B0aW9ucyBhcnJheVxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBpbml0KFxuICAgIGhhc1Njb3JlOiBib29sZWFuID0gdHJ1ZSxcbiAgICBoYXNIaWdoU2NvcmU6IGJvb2xlYW4gPSB0cnVlXG4gICk6IHZvaWQge1xuICAgIHRoaXMuZGVidWcoXCJTREsgSW5pdGlhbGl6YXRpb25cIik7XG5cbiAgICAvLyBJbml0IHRoZSB1aU9wdGlvbnNcbiAgICBjb25zdCB1aU9wdGlvbnMgPSBbXCJzY29yZVwiLCBcImhpZ2hTY29yZVwiLCBoYXNTY29yZSwgaGFzSGlnaFNjb3JlXTtcblxuICAgIC8vIElmIFNESyBpcyBub3QgbG9hZGVkIHlldFxuICAgIGlmICghdGhpcy5pc0xvYWRlZCkge1xuICAgICAgLy8gU2VuZCB0aGUgaW5pdCBtZXNzYWdlXG4gICAgICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKFxuICAgICAgICB7XG4gICAgICAgICAgY29udHJvbGxlcjogXCJfZGlnaXRhcEdhbWVcIixcbiAgICAgICAgICB0eXBlOiBcIlNES19TRVRUSU5HU1wiLFxuICAgICAgICAgIHVpOiB1aU9wdGlvbnMsXG4gICAgICAgICAgcmVhZHk6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIFwiKlwiXG4gICAgICApO1xuXG4gICAgICAvLyBXYXRjaCBmb3IgbWVzc2FnZXMgZnJvbSBHYW1lQm94XG4gICAgICB0aGlzLmxpc3RlbkdhbWVib3hFdmVudHMoKTtcblxuICAgICAgLy8gV2F0Y2ggZm9yIG1lc3NhZ2VzIGZyb20gU3RyZWFtclxuICAgICAgLy8gdGhpcy5saXN0ZW5TdHJlYW1yRXZlbnRzKCk7XG5cbiAgICAgIC8vIFNldCB0aGUgY2FudmFzIGZ1bGx3aWR0aCAmIGJsdWUgc2NyZWVuIGZpeFxuICAgICAgY29uc3QgY2FudmFzOiBIVE1MQ29sbGVjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiY2FudmFzXCIpO1xuICAgICAgY29uc3QgaHRtbDogSFRNTENvbGxlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImh0bWxcIik7XG5cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBsZXQgY2FudmFzU3R5bGUgPSBjYW52YXNbMF0uZ2V0QXR0cmlidXRlKFwic3R5bGVcIik7XG4gICAgICAgIGNhbnZhc1swXS5zZXRBdHRyaWJ1dGUoXG4gICAgICAgICAgXCJzdHlsZVwiLFxuICAgICAgICAgIGNhbnZhc1N0eWxlICtcbiAgICAgICAgICAgIFwid2lkdGg6IDEwMCU7IG1hcmdpbjogMDsgcGFkZGluZzogMDsgdXNlci1zZWxlY3Q6IG5vbmU7IC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7IC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7XCJcbiAgICAgICAgKTtcblxuICAgICAgICBsZXQgaHRtbFN0eWxlID0gaHRtbFswXS5nZXRBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcbiAgICAgICAgaHRtbFswXS5zZXRBdHRyaWJ1dGUoXG4gICAgICAgICAgXCJzdHlsZVwiLFxuICAgICAgICAgIChodG1sU3R5bGUgPyBodG1sU3R5bGUgOiBcIlwiKSArXG4gICAgICAgICAgICBcInVzZXItc2VsZWN0OiBub25lOyAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lOyAtbW96LXVzZXItc2VsZWN0OiBub25lO1wiXG4gICAgICAgICk7XG4gICAgICB9LCAyMDAwKTtcbiAgICB9XG5cbiAgICAvLyBTZXQgU0RLIGFzIGxvYWRlZCB0byBwcmV2ZW50IHJlLWluaXRpYXRpb25cbiAgICB0aGlzLmlzTG9hZGVkID0gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgcHJvZ3Jlc3Mgb2YgYSBnYW1lLlxuICAgKlxuICAgKiBAcGFyYW0gdHlwZSBzdHJpbmdcbiAgICogQHBhcmFtIHN0YXRlIHN0cmluZ1xuICAgKiBAcGFyYW0gc2NvcmUgbnVtYmVyXG4gICAqIEBwYXJhbSBsZXZlbCBudW1iZXJcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc2V0UHJvZ3Jlc3Moc3RhdGU6IHN0cmluZywgc2NvcmU6IG51bWJlciwgbGV2ZWw6IG51bWJlcik6IHZvaWQge1xuICAgIC8vIFNldCB0aGUgY3VycmVudCBwcm9ncmVzc1xuICAgIHRoaXMucHJvZ3Jlc3MgPSB7XG4gICAgICB0eXBlOiBcIlNES19QTEFZRVJfU0NPUkVfVVBEQVRFXCIsXG4gICAgICBzdGF0ZSxcbiAgICAgIHNjb3JlLFxuICAgICAgbGV2ZWwsXG4gICAgICBjb250aW51ZVNjb3JlOiBzY29yZSxcbiAgICAgIGNvbnRyb2xsZXI6IFwiX2RpZ2l0YXBHYW1lXCIsXG4gICAgfTtcblxuICAgIHRoaXMuc2VuZERhdGEoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIG5ldyBsZXZlbCBvZiB0aGUgZ2FtZS5cbiAgICpcbiAgICogQHBhcmFtIGxldmVsIG51bWJlclxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBzZXRMZXZlbFVwKGxldmVsOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnByb2dyZXNzLmxldmVsID0gbGV2ZWw7XG4gICAgdGhpcy5wcm9ncmVzcy50eXBlID0gXCJTREtfUExBWUVSX0xFVkVMX1VQXCI7XG5cbiAgICB0aGlzLnNlbmREYXRhKCk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoZSBnYW1lIGFzIGZhaWxlZC5cbiAgICpcbiAgICogQHBhcmFtIHN0YXRlIHN0cmluZ1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyBzZXRQbGF5ZXJGYWlsZWQoc3RhdGU6IHN0cmluZyA9IFwiRkFJTFwiKTogdm9pZCB7XG4gICAgdGhpcy5wcm9ncmVzcy5zdGF0ZSA9IHN0YXRlO1xuICAgIHRoaXMucHJvZ3Jlc3Muc2NvcmUgPSAwO1xuICAgIHRoaXMucHJvZ3Jlc3MudHlwZSA9IFwiU0RLX1BMQVlFUl9GQUlMRURcIjtcblxuICAgIHRoaXMuc2VuZERhdGEoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZW5kcyBnYW1lIGRhdGEgdG8gcGFyZW50IHBsYXRmb3JtLlxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgc2VuZERhdGEoKTogdm9pZCB7XG4gICAgLy8gU2VuZCB0aGUgbWVzc2FnZSB0byBHYW1lYm94LlxuICAgIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UodGhpcy5wcm9ncmVzcywgdGhpcy5vcmlnaW4pO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IGxpc3RlbmluZyBmb3IgbWVzc2FnZXNcbiAgICogZnJvbSB0aGUgcGxhdGZvcm0uXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBsaXN0ZW5HYW1lYm94RXZlbnRzKCk6IHZvaWQge1xuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICBcIm1lc3NhZ2VcIixcbiAgICAgIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBzZWxmLmRlYnVnKFwiRXZlbnQgUmVjZWl2ZWQgLT4gJW8gLT4gJW9cIiwgZXZlbnQuZGF0YSwgZXZlbnQub3JpZ2luKTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgdHlwZW9mIGV2ZW50LmRhdGEgPT0gXCJvYmplY3RcIiAmJlxuICAgICAgICAgIGV2ZW50LmRhdGEuY29udHJvbGxlciAmJlxuICAgICAgICAgIGV2ZW50LmRhdGEuY29udHJvbGxlciA9PSBcIl9kaWdpdGFwQXBwXCJcbiAgICAgICAgKSB7XG4gICAgICAgICAgbGV0IG9yaWdpbkluZGV4ID0gc2VsZi5hbGxvd2VkT3JpZ2lucy5pbmRleE9mKGV2ZW50Lm9yaWdpbik7XG5cbiAgICAgICAgICBpZiAob3JpZ2luSW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICBzZWxmLmRlYnVnKFwiRXJyb3I6IE9yaWdpbiBub3QgYWxsb3dlZCBpbnNpZGUgZ2FtZSBjb250YWluZXIhXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxmLm9yaWdpbiA9IHNlbGYuYWxsb3dlZE9yaWdpbnNbb3JpZ2luSW5kZXhdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChldmVudC5kYXRhLnR5cGUpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZXZlbnQuZGF0YS50eXBlKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJTREtfU1RBUlRfR0FNRVwiOlxuICAgICAgICAgICAgICAgIHNlbGYuYWZ0ZXJTdGFydEdhbWUoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIFwiU0RLX1BBVVNFX0dBTUVcIjpcbiAgICAgICAgICAgICAgICBzZWxmLmFmdGVyUGF1c2VHYW1lKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSBcIlNES19TVEFSVF9HQU1FX0ZST01fWkVST1wiOlxuICAgICAgICAgICAgICAgIHNlbGYucHJvZ3Jlc3Muc2NvcmUgPSAwO1xuICAgICAgICAgICAgICAgIHNlbGYucHJvZ3Jlc3MubGV2ZWwgPSAwO1xuICAgICAgICAgICAgICAgIHNlbGYucHJvZ3Jlc3MuY29udGludWVTY29yZSA9IDA7XG5cbiAgICAgICAgICAgICAgICBzZWxmLmFmdGVyU3RhcnRHYW1lRnJvbVplcm8oKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIFwiU0RLX0NPTlRJTlVFX1dJVEhfQ1VSUkVOVF9TQ09SRVwiOlxuICAgICAgICAgICAgICAgIHNlbGYucHJvZ3Jlc3Muc2NvcmUgPSBzZWxmLnByb2dyZXNzLmNvbnRpbnVlU2NvcmU7XG5cbiAgICAgICAgICAgICAgICBzZWxmLmFmdGVyQ29udGludWVXaXRoQ3VycmVudFNjb3JlKFxuICAgICAgICAgICAgICAgICAgc2VsZi5wcm9ncmVzcy5zY29yZSxcbiAgICAgICAgICAgICAgICAgIHNlbGYucHJvZ3Jlc3MubGV2ZWxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgc2VsZi5kZWJ1ZyhcbiAgICAgICAgICAgICAgICAgICdFcnJvcjogYGRhdGEudHlwZWAgPSBcIicgK1xuICAgICAgICAgICAgICAgICAgICBldmVudC5kYXRhLnR5cGUgK1xuICAgICAgICAgICAgICAgICAgICAnXCIgbm90IGZvdW5kISBQbGVhc2UgY2hlY2sgYHJlYWRtZS5tZGAgb2YgZGF0YSBjb2xsZWN0b3IgcGFja2FnZSEnXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5kZWJ1ZyhcIkVycm9yOiBgZXZlbnQuZGF0YS50eXBlYCBzaG91bGQgYmUgaW1wbGVtZW50ZWQhXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGZhbHNlXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydCBsaXN0ZW5pbmcgZm9yIG1lc3NhZ2VzXG4gICAqIGZyb20gdGhlIFN0cmVhbXIgcGxhdGZvcm0uXG4gICAqL1xuICAvLyBwcml2YXRlIHN0YXRpYyBsaXN0ZW5TdHJlYW1yRXZlbnRzKCk6IHZvaWQge1xuICAvLyAgIGxldCBjYW52YXM6IENhbnZhc0VsZW1lbnQgPSBudWxsO1xuICAvLyAgIGxldCBzdHJlYW06IGFueSA9IG51bGw7XG4gIC8vICAgbGV0IGNvbm5lY3Rpb246IGFueSA9IG51bGw7XG4gIC8vICAgbGV0IGNoYW5uZWw6IGFueSA9IG51bGw7XG4gIC8vICAgbGV0IGljZUNhbmRpZGF0ZTogYW55ID0gbnVsbDtcbiAgLy8gICBsZXQgY29ubmVjdGVkID0gZmFsc2U7XG4gIC8vICAgbGV0IGlzTmVnb3RpYXRpb25OZWVkZWQgPSBmYWxzZTtcblxuICAvLyAgIGxldCBzZWxmID0gdGhpcztcbiAgLy8gICBzZWxmLmRlYnVnKFwiSW5pdCBTdHJlYW1yIHYxLjAuM1wiKTtcblxuICAvLyAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBhc3luYyAoZXZlbnQpID0+IHtcbiAgLy8gICAgIHRyeSB7XG4gIC8vICAgICAgIHNlbGYuZGVidWcoXCJTdHJlYW1yIEV2ZW50IHJlY2VpdmVkXCIsIGV2ZW50LmRhdGEpO1xuXG4gIC8vICAgICAgIGlmICghZXZlbnQuZGF0YSB8fCB0eXBlb2YgZXZlbnQuZGF0YSAhPT0gXCJvYmplY3RcIikge1xuICAvLyAgICAgICAgIHJldHVybjtcbiAgLy8gICAgICAgfVxuXG4gIC8vICAgICAgIGNvbnN0IHsgY29udHJvbGxlciwgdHlwZSwgYWN0aW9uLCBvZmZlciwgdG91cm5hbWVudF9pZCwgdXNlcm5hbWUgfSA9XG4gIC8vICAgICAgICAgZXZlbnQuZGF0YTtcblxuICAvLyAgICAgICBzZWxmLmRlYnVnKFxuICAvLyAgICAgICAgIFwiU3RyZWFtciBFdmVudCBkZXRhaWxzOiBcIixcbiAgLy8gICAgICAgICBjb250cm9sbGVyLFxuICAvLyAgICAgICAgIHR5cGUsXG4gIC8vICAgICAgICAgYWN0aW9uLFxuICAvLyAgICAgICAgIG9mZmVyLFxuICAvLyAgICAgICAgIHRvdXJuYW1lbnRfaWQsXG4gIC8vICAgICAgICAgdXNlcm5hbWVcbiAgLy8gICAgICAgKTtcblxuICAvLyAgICAgICBpZiAoY29udHJvbGxlciAhPT0gXCJfZGlnaXRhcEFwcFwiICYmIHR5cGUgIT09IFwid2VicnRjXCIpIHtcbiAgLy8gICAgICAgICByZXR1cm47XG4gIC8vICAgICAgIH1cblxuICAvLyAgICAgICBpZiAoIWNvbm5lY3RlZCkge1xuICAvLyAgICAgICAgIGNhbnZhcyA9IDxDYW52YXNFbGVtZW50PmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJjYW52YXNcIik7XG4gIC8vICAgICAgICAgc3RyZWFtID0gY2FudmFzLmNhcHR1cmVTdHJlYW0oMzApO1xuICAvLyAgICAgICAgIGNvbm5lY3Rpb24gPSBuZXcgUlRDUGVlckNvbm5lY3Rpb24oe1xuICAvLyAgICAgICAgICAgaWNlU2VydmVyczogW3sgdXJsczogXCJzdHVuOnN0dW4ubC5nb29nbGUuY29tOjE5MzAyXCIgfV0sXG4gIC8vICAgICAgICAgfSk7XG4gIC8vICAgICAgICAgY2hhbm5lbCA9IGNvbm5lY3Rpb24uY3JlYXRlRGF0YUNoYW5uZWwoXG4gIC8vICAgICAgICAgICBgc3RyZWFtci0ke3RvdXJuYW1lbnRfaWR9LSR7dXNlcm5hbWV9YCxcbiAgLy8gICAgICAgICAgIHtcbiAgLy8gICAgICAgICAgICAgbmVnb3RpYXRlZDogdHJ1ZSxcbiAgLy8gICAgICAgICAgICAgaWQ6IDAsXG4gIC8vICAgICAgICAgICB9XG4gIC8vICAgICAgICAgKTtcbiAgLy8gICAgICAgfVxuXG4gIC8vICAgICAgIGlmIChhY3Rpb24gPT09IFwiY2xvc2VcIikge1xuICAvLyAgICAgICAgIGZvciAobGV0IHNlbmRlciBvZiBjb25uZWN0aW9uLmdldFNlbmRlcnMoKSkge1xuICAvLyAgICAgICAgICAgY29ubmVjdGlvbi5yZW1vdmVUcmFjayhzZW5kZXIpO1xuICAvLyAgICAgICAgIH1cblxuICAvLyAgICAgICAgIGNhbnZhcyA9IG51bGw7XG4gIC8vICAgICAgICAgc3RyZWFtID0gbnVsbDtcblxuICAvLyAgICAgICAgIGNoYW5uZWwuc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6IFwic3RyZWFtclwiLCBhY3Rpb246IFwiY2xvc2VcIiB9KSk7XG4gIC8vICAgICAgICAgY29ubmVjdGlvbi5jbG9zZSgpO1xuXG4gIC8vICAgICAgICAgY29ubmVjdGlvbiA9IG51bGw7XG4gIC8vICAgICAgICAgY2hhbm5lbCA9IG51bGw7XG4gIC8vICAgICAgICAgaWNlQ2FuZGlkYXRlID0gbnVsbDtcbiAgLy8gICAgICAgICBjb25uZWN0ZWQgPSBmYWxzZTtcbiAgLy8gICAgICAgICBpc05lZ290aWF0aW9uTmVlZGVkID0gZmFsc2U7XG4gIC8vICAgICAgICAgcmV0dXJuO1xuICAvLyAgICAgICB9XG5cbiAgLy8gICAgICAgaWYgKGFjdGlvbiA9PT0gXCJpbml0XCIpIHtcbiAgLy8gICAgICAgICBmb3IgKGNvbnN0IHRyYWNrIG9mIHN0cmVhbS5nZXRUcmFja3MoKSkge1xuICAvLyAgICAgICAgICAgY29ubmVjdGlvbi5hZGRUcmFjayh0cmFjaywgc3RyZWFtKTtcbiAgLy8gICAgICAgICB9XG5cbiAgLy8gICAgICAgICBjb25zdCBvbkNvbm5lY3Rpb25TdGF0ZUNoYW5nZSA9IChlOiBhbnkpID0+IHtcbiAgLy8gICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAvLyAgICAgICAgICAgICBcIl9fV0VCUlRDLm9uQ29ubmVjdGlvblN0YXRlQ2hhbmdlX19cIixcbiAgLy8gICAgICAgICAgICAgY29ubmVjdGlvbi5jb25uZWN0aW9uU3RhdGVcbiAgLy8gICAgICAgICAgICk7XG4gIC8vICAgICAgICAgICBzd2l0Y2ggKGNvbm5lY3Rpb24uY29ubmVjdGlvblN0YXRlKSB7XG4gIC8vICAgICAgICAgICAgIGNhc2UgXCJjb25uZWN0ZWRcIjpcbiAgLy8gICAgICAgICAgICAgICBjb25uZWN0ZWQgPSB0cnVlO1xuXG4gIC8vICAgICAgICAgICAgICAgKDxXaW5kb3c+ZXZlbnQuc291cmNlKS5wb3N0TWVzc2FnZShcbiAgLy8gICAgICAgICAgICAgICAgIHsgdHlwZTogXCJzdHJlYW1yXCIsIGFjdGlvbjogXCJjb25uZWN0ZWRcIiB9LFxuICAvLyAgICAgICAgICAgICAgICAgZXZlbnQub3JpZ2luXG4gIC8vICAgICAgICAgICAgICAgKTtcbiAgLy8gICAgICAgICAgICAgICBicmVhaztcbiAgLy8gICAgICAgICAgICAgY2FzZSBcImRpc2Nvbm5lY3RlZFwiOlxuICAvLyAgICAgICAgICAgICAgIGZvciAobGV0IHNlbmRlciBvZiBjb25uZWN0aW9uLmdldFNlbmRlcnMoKSkge1xuICAvLyAgICAgICAgICAgICAgICAgY29ubmVjdGlvbi5yZW1vdmVUcmFjayhzZW5kZXIpO1xuICAvLyAgICAgICAgICAgICAgIH1cbiAgLy8gICAgICAgICAgICAgICBjYW52YXMgPSBudWxsO1xuICAvLyAgICAgICAgICAgICAgIHN0cmVhbSA9IG51bGw7XG5cbiAgLy8gICAgICAgICAgICAgICAoPFdpbmRvdz5ldmVudC5zb3VyY2UpLnBvc3RNZXNzYWdlKFxuICAvLyAgICAgICAgICAgICAgICAgeyB0eXBlOiBcInN0cmVhbXJcIiwgYWN0aW9uOiBcImRpc2Nvbm5lY3RlZFwiIH0sXG4gIC8vICAgICAgICAgICAgICAgICBldmVudC5vcmlnaW5cbiAgLy8gICAgICAgICAgICAgICApO1xuXG4gIC8vICAgICAgICAgICAgICAgY2hhbm5lbC5jbG9zZSgpO1xuICAvLyAgICAgICAgICAgICAgIGNvbm5lY3Rpb24uY2xvc2UoKTtcbiAgLy8gICAgICAgICAgICAgICBjb25uZWN0aW9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gIC8vICAgICAgICAgICAgICAgICBcImNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLFxuICAvLyAgICAgICAgICAgICAgICAgb25Db25uZWN0aW9uU3RhdGVDaGFuZ2VcbiAgLy8gICAgICAgICAgICAgICApO1xuICAvLyAgICAgICAgICAgICAgIGNvbm5lY3Rpb24ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgLy8gICAgICAgICAgICAgICAgIFwiaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXCIsXG4gIC8vICAgICAgICAgICAgICAgICBvbkljZUNvbm5lY3Rpb25TdGF0ZUNoYW5nZVxuICAvLyAgICAgICAgICAgICAgICk7XG4gIC8vICAgICAgICAgICAgICAgY29ubmVjdGlvbi5yZW1vdmVFdmVudExpc3RlbmVyKFwiaWNlY2FuZGlkYXRlXCIsIG9uSWNlQ2FuZGlkYXRlKTtcbiAgLy8gICAgICAgICAgICAgICBjb25uZWN0aW9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gIC8vICAgICAgICAgICAgICAgICBcIm9ubmVnb3RpYXRpb25uZWVkZWRcIixcbiAgLy8gICAgICAgICAgICAgICAgIG9uTmVnb3RpYXRpb25OZWVkZWRcbiAgLy8gICAgICAgICAgICAgICApO1xuICAvLyAgICAgICAgICAgICAgIGNvbm5lY3Rpb24ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgLy8gICAgICAgICAgICAgICAgIFwib25zaWduYWxpbmdzdGF0ZWNoYW5nZVwiLFxuICAvLyAgICAgICAgICAgICAgICAgb25TaWduYWxpbmdTdGF0ZUNoYW5nZVxuICAvLyAgICAgICAgICAgICAgICk7XG4gIC8vICAgICAgICAgICAgICAgY2hhbm5lbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBvbk1lc3NhZ2UpO1xuXG4gIC8vICAgICAgICAgICAgICAgY29ubmVjdGlvbiA9IG51bGw7XG4gIC8vICAgICAgICAgICAgICAgY2hhbm5lbCA9IG51bGw7XG4gIC8vICAgICAgICAgICAgICAgaWNlQ2FuZGlkYXRlID0gbnVsbDtcbiAgLy8gICAgICAgICAgICAgICBjb25uZWN0ZWQgPSBmYWxzZTtcblxuICAvLyAgICAgICAgICAgICAgIGJyZWFrO1xuICAvLyAgICAgICAgICAgfVxuICAvLyAgICAgICAgIH07XG5cbiAgLy8gICAgICAgICBjb25zdCBvbkljZUNvbm5lY3Rpb25TdGF0ZUNoYW5nZSA9IChldmVudDogYW55KSA9PiB7XG4gIC8vICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgLy8gICAgICAgICAgICAgXCJfX1dFQlJUQy5vbklDRUNvbm5lY3Rpb25TdGF0ZUNoYW5nZV9fXCIsXG4gIC8vICAgICAgICAgICAgIGNvbm5lY3Rpb24uaWNlQ29ubmVjdGlvblN0YXRlXG4gIC8vICAgICAgICAgICApO1xuICAvLyAgICAgICAgICAgc3dpdGNoIChjb25uZWN0aW9uLmljZUNvbm5lY3Rpb25TdGF0ZSkge1xuICAvLyAgICAgICAgICAgICBjYXNlIFwiY29ubmVjdGVkXCI6XG4gIC8vICAgICAgICAgICAgICAgYnJlYWs7XG4gIC8vICAgICAgICAgICAgIGNhc2UgXCJkaXNjb25uZWN0ZWRcIjpcbiAgLy8gICAgICAgICAgICAgY2FzZSBcImZhaWxlZFwiOlxuICAvLyAgICAgICAgICAgICAgIGNvbm5lY3Rpb24ucmVzdGFydEljZSgpO1xuICAvLyAgICAgICAgICAgICAgIGJyZWFrO1xuICAvLyAgICAgICAgICAgfVxuICAvLyAgICAgICAgIH07XG5cbiAgLy8gICAgICAgICBjb25zdCBvbkljZUNhbmRpZGF0ZSA9IChlOiBhbnkpID0+IHtcbiAgLy8gICAgICAgICAgIHRyeSB7XG4gIC8vICAgICAgICAgICAgIHNlbGYuZGVidWcoXCJfX1dFQlJUQy5vbklDRUNhbmRpZGF0ZV9fXCIsIGUuY2FuZGlkYXRlKTtcblxuICAvLyAgICAgICAgICAgICBpZiAoZS5jYW5kaWRhdGUpIHtcbiAgLy8gICAgICAgICAgICAgICBpY2VDYW5kaWRhdGUgPSBlLmNhbmRpZGF0ZTtcbiAgLy8gICAgICAgICAgICAgfSBlbHNlIHtcbiAgLy8gICAgICAgICAgICAgICBzZWxmLmRlYnVnKFxuICAvLyAgICAgICAgICAgICAgICAgXCJfX1dFQlJUQy5sb2NhbERlc2NyaXB0aW9uX19cIixcbiAgLy8gICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24ubG9jYWxEZXNjcmlwdGlvblxuICAvLyAgICAgICAgICAgICAgICk7XG5cbiAgLy8gICAgICAgICAgICAgICAoPFdpbmRvdz5ldmVudC5zb3VyY2UpLnBvc3RNZXNzYWdlKFxuICAvLyAgICAgICAgICAgICAgICAge1xuICAvLyAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmVhbXJcIixcbiAgLy8gICAgICAgICAgICAgICAgICAgYWN0aW9uOiBcImFuc3dlclwiLFxuICAvLyAgICAgICAgICAgICAgICAgICBvZmZlcjogd2luZG93LmJ0b2EoXG4gIC8vICAgICAgICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoY29ubmVjdGlvbi5sb2NhbERlc2NyaXB0aW9uKVxuICAvLyAgICAgICAgICAgICAgICAgICApLFxuICAvLyAgICAgICAgICAgICAgICAgfSxcbiAgLy8gICAgICAgICAgICAgICAgIGV2ZW50Lm9yaWdpblxuICAvLyAgICAgICAgICAgICAgICk7XG4gIC8vICAgICAgICAgICAgIH1cbiAgLy8gICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAvLyAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiX19XRUJSVEMub25JQ0VDYW5kaWRhdGVfX1wiLCBlcnIubWVzc2FnZSk7XG4gIC8vICAgICAgICAgICB9XG4gIC8vICAgICAgICAgfTtcblxuICAvLyAgICAgICAgIGNvbnN0IG9uTWVzc2FnZSA9IGFzeW5jIChldmVudDogYW55KSA9PiB7XG4gIC8vICAgICAgICAgICB0cnkge1xuICAvLyAgICAgICAgICAgICBpZiAoIWV2ZW50LmRhdGEpIHtcbiAgLy8gICAgICAgICAgICAgICByZXR1cm47XG4gIC8vICAgICAgICAgICAgIH1cblxuICAvLyAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gSlNPTi5wYXJzZShldmVudC5kYXRhKTtcblxuICAvLyAgICAgICAgICAgICBpZiAobWVzc2FnZS5pY2VDYW5kaWRhdGUpIHtcbiAgLy8gICAgICAgICAgICAgICBhd2FpdCBjb25uZWN0aW9uLmFkZEljZUNhbmRpZGF0ZShtZXNzYWdlLmljZUNhbmRpZGF0ZSk7XG4gIC8vICAgICAgICAgICAgICAgY2hhbm5lbC5zZW5kKEpTT04uc3RyaW5naWZ5KHsgaWNlQ2FuZGlkYXRlIH0pKTtcbiAgLy8gICAgICAgICAgICAgfVxuICAvLyAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gIC8vICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJfX1dFQlJUQy5vbk1lc3NhZ2VfX1wiLCBlcnIubWVzc2FnZSk7XG4gIC8vICAgICAgICAgICB9XG4gIC8vICAgICAgICAgfTtcblxuICAvLyAgICAgICAgIGNvbnN0IG9uTmVnb3RpYXRpb25OZWVkZWQgPSBhc3luYyAoZXZlbnQ6IGFueSkgPT4ge1xuICAvLyAgICAgICAgICAgdHJ5IHtcbiAgLy8gICAgICAgICAgICAgaWYgKGlzTmVnb3RpYXRpb25OZWVkZWQpIHtcbiAgLy8gICAgICAgICAgICAgICByZXR1cm47XG4gIC8vICAgICAgICAgICAgIH1cblxuICAvLyAgICAgICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnNldFJlbW90ZURlc2NyaXB0aW9uKEpTT04ucGFyc2Uob2ZmZXIpKTtcbiAgLy8gICAgICAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5zZXRMb2NhbERlc2NyaXB0aW9uKFxuICAvLyAgICAgICAgICAgICAgIGF3YWl0IGNvbm5lY3Rpb24uY3JlYXRlQW5zd2VyKClcbiAgLy8gICAgICAgICAgICAgKTtcbiAgLy8gICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAvLyAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiX19XRUJSVEMub25OZWdvdGlhdGlvbk5lZWRlZFwiLCBlcnIubWVzc2FnZSk7XG4gIC8vICAgICAgICAgICB9XG4gIC8vICAgICAgICAgfTtcblxuICAvLyAgICAgICAgIGNvbnN0IG9uU2lnbmFsaW5nU3RhdGVDaGFuZ2UgPSAoZTogYW55KSA9PlxuICAvLyAgICAgICAgICAgKGlzTmVnb3RpYXRpb25OZWVkZWQgPSBjb25uZWN0aW9uLnNpZ25hbGluZ1N0YXRlICE9PSBcInN0YWJsZVwiKTtcblxuICAvLyAgICAgICAgIGNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcihcbiAgLy8gICAgICAgICAgIFwiY29ubmVjdGlvbnN0YXRlY2hhbmdlXCIsXG4gIC8vICAgICAgICAgICBvbkNvbm5lY3Rpb25TdGF0ZUNoYW5nZVxuICAvLyAgICAgICAgICk7XG4gIC8vICAgICAgICAgY29ubmVjdGlvbi5hZGRFdmVudExpc3RlbmVyKFxuICAvLyAgICAgICAgICAgXCJpY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2VcIixcbiAgLy8gICAgICAgICAgIG9uSWNlQ29ubmVjdGlvblN0YXRlQ2hhbmdlXG4gIC8vICAgICAgICAgKTtcbiAgLy8gICAgICAgICBjb25uZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoXCJpY2VjYW5kaWRhdGVcIiwgb25JY2VDYW5kaWRhdGUpO1xuICAvLyAgICAgICAgIGNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcihcbiAgLy8gICAgICAgICAgIFwib25uZWdvdGlhdGlvbm5lZWRlZFwiLFxuICAvLyAgICAgICAgICAgb25OZWdvdGlhdGlvbk5lZWRlZFxuICAvLyAgICAgICAgICk7XG4gIC8vICAgICAgICAgY29ubmVjdGlvbi5hZGRFdmVudExpc3RlbmVyKFxuICAvLyAgICAgICAgICAgXCJvbnNpZ25hbGluZ3N0YXRlY2hhbmdlXCIsXG4gIC8vICAgICAgICAgICBvblNpZ25hbGluZ1N0YXRlQ2hhbmdlXG4gIC8vICAgICAgICAgKTtcbiAgLy8gICAgICAgICBjaGFubmVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG9uTWVzc2FnZSk7XG5cbiAgLy8gICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnNldFJlbW90ZURlc2NyaXB0aW9uKEpTT04ucGFyc2Uob2ZmZXIpKTtcbiAgLy8gICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnNldExvY2FsRGVzY3JpcHRpb24oYXdhaXQgY29ubmVjdGlvbi5jcmVhdGVBbnN3ZXIoKSk7XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH0gY2F0Y2ggKGVycikge1xuICAvLyAgICAgICBjb25zb2xlLmVycm9yKFwiX19XRUJSVENfX1wiLCBlcnIubWVzc2FnZSk7XG4gIC8vICAgICB9XG4gIC8vICAgfSk7XG4gIC8vIH1cblxuICAvKipcbiAgICogRW1wdHkgbWV0aG9kcyBmb3IgZ2FtZSBkZXZlbG9wZXIgdG8gdXNlLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBhZnRlclN0YXJ0R2FtZUZyb21aZXJvKCkge31cblxuICBwdWJsaWMgc3RhdGljIGFmdGVyQ29udGludWVXaXRoQ3VycmVudFNjb3JlKHNjb3JlOiBudW1iZXIsIGxldmVsOiBudW1iZXIpIHt9XG5cbiAgcHVibGljIHN0YXRpYyBhZnRlclN0YXJ0R2FtZSgpIHt9XG5cbiAgcHVibGljIHN0YXRpYyBhZnRlclBhdXNlR2FtZSgpIHt9XG5cbiAgLyoqXG4gICAqIElmIHVzZXIgaXMgZGVidWdnaW5nLCBzaG93IHNvbWUgY29uc29sZSBsb2dzLlxuICAgKlxuICAgKiBAcGFyYW0gbWVzc2FnZSBhbnlcbiAgICogQHBhcmFtIHBhcmFtcyBhbnlbXVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZGVidWcobWVzc2FnZT86IGFueSwgLi4ucGFyYW1zOiBhbnlbXSk6IHZvaWQge1xuICAgIGNvbnN0IHBhcmVudFdpbmRvdzogYW55ID0gd2luZG93O1xuXG4gICAgaWYgKHBhcmVudFdpbmRvdy5zZGtkZWJ1Zykge1xuICAgICAgY29uc29sZS5sb2coXCJEaWdpdGFwR2FtZVBsYXllclNESyAtPiBcIiArIG1lc3NhZ2UsIC4uLnBhcmFtcyk7XG4gICAgfVxuICB9XG59XG5cbi8vIFJlYWQgdGhlIGN1cnJlbnQgcXVldWVcbmlmICh0eXBlb2YgKDxhbnk+d2luZG93KS5kaWdpdGFwU0RLICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gIGxldCBvbGRRdWV1ZSA9ICg8YW55PndpbmRvdykuZGlnaXRhcFNESy5xO1xuICBEaWdpdGFwR2FtZVBsYXllclNESy5wcm9jZXNzT2xkUXVldWUob2xkUXVldWUpO1xufVxuXG4vLyBXYXRjaCB0aGUgcXVldWUgd2l0aCBuZXcgbWV0aG9kXG4oPGFueT53aW5kb3cpLmRpZ2l0YXBTREsgPSBEaWdpdGFwR2FtZVBsYXllclNESy5wcm9jZXNzUXVldWU7XG5cbi8vIEZvcmNlIHRoZSBsb2dzIHRvIGJlIGhpZGRlblxuY29uc3QgbG9nID0gd2luZG93LmNvbnNvbGUubG9nO1xud2luZG93LmNvbnNvbGUubG9nID0gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueSkge1xuICByZXR1cm4gdHJ1ZTtcbn07XG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZVxuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbl9fd2VicGFja19tb2R1bGVzX19bNjA3XSgpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==