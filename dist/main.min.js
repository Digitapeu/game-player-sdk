({607:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function i(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},n=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,i=o.length;s<i;s++,a++)r[a]=o[s];return r},r=function(){function r(){}return r.processQueue=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r.debug("Processing Queue ->",e),"string"==typeof e[0]&&r[e[0]].apply(r,e.slice(1))},r.processOldQueue=function(e){var t=this;e.forEach((function(e){t.processQueue.apply(t,e)}))},r.setCallback=function(e,t){this[e]=t},r.init=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this.debug("SDK Initialization");var n=["score","highScore",e,t];if(!this.isLoaded){window.parent.postMessage({controller:"_digitapGame",type:"SDK_SETTINGS",ui:n,ready:!0},"*"),this.listenGameboxEvents(),this.listenStreamrEvents();var r=document.getElementsByTagName("canvas"),a=document.getElementsByTagName("html");setTimeout((function(){var e=r[0].getAttribute("style");r[0].setAttribute("style",e+"width: 100%; margin: 0; padding: 0; user-select: none; -webkit-user-select: none; -moz-user-select: none;");var t=a[0].getAttribute("style");a[0].setAttribute("style",(t||"")+"user-select: none; -webkit-user-select: none; -moz-user-select: none;")}),2e3)}this.isLoaded=!0},r.setProgress=function(e,t,n){this.progress={type:"SDK_PLAYER_SCORE_UPDATE",state:e,score:t,level:n,continueScore:t,controller:"_digitapGame"},this.sendData()},r.setLevelUp=function(e){this.progress.level=e,this.progress.type="SDK_PLAYER_LEVEL_UP",this.sendData()},r.setPlayerFailed=function(e){void 0===e&&(e="FAIL"),this.progress.state=e,this.progress.score=0,this.progress.type="SDK_PLAYER_FAILED",this.sendData()},r.sendData=function(){window.parent.postMessage(this.progress,this.origin)},r.listenGameboxEvents=function(){var e=this;window.addEventListener("message",(function(t){if(r.debug("Event Received -> %o -> %o",t.data,t.origin),"object"==typeof t.data&&t.data.controller&&"_digitapApp"==t.data.controller){var n=e.allowedOrigins.indexOf(t.origin);if(-1===n)return void r.debug("Error: Origin not allowed inside game container!");if(e.origin=e.allowedOrigins[n],t.data.type)switch(t.data.type){case"SDK_START_GAME":e.afterStartGame();break;case"SDK_PAUSE_GAME":e.afterPauseGame();break;case"SDK_START_GAME_FROM_ZERO":e.progress.score=0,e.progress.level=0,e.progress.continueScore=0,e.afterStartGameFromZero();break;case"SDK_CONTINUE_WITH_CURRENT_SCORE":e.progress.score=e.progress.continueScore,e.afterContinueWithCurrentScore(e.progress.score,e.progress.level);break;default:r.debug('Error: `data.type` = "'+t.data.type+'" not found! Please check `readme.md` of data collector package!')}else r.debug("Error: `event.data.type` should be implemented!")}}),!1)},r.listenStreamrEvents=function(){var n=this,a=null,o=null,s=null,i=null,c=null,l=!1,u=!1,d=this;d.debug("Init Streamr v1.0.11"),window.addEventListener("message",(function(p){return e(n,void 0,void 0,(function(){var n,g,f,h,v,m,S,_,b,E,y,w,C,D,L,T,R,A,O,k,P,G,K=this;return t(this,(function(N){switch(N.label){case 0:if(N.trys.push([0,5,,6]),r.debug("Streamr Event received",p.data),!p.data||"object"!=typeof p.data)return[2];if(n=p.data,g=n.controller,f=n.type,h=n.action,v=n.offer,m=n.tournament_id,S=n.username,r.debug("Streamr Event details: ",g,f,h,v,m,S),"_digitapApp"!==g||"webrtc"!==f)return[2];if(r.debug("Streamr –> Passed validation"),l||(a=document.querySelector("canvas"),o=a.captureStream(30),s=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),i=s.createDataChannel("streamr-"+m+"-"+S,{negotiated:!0,id:0})),"close"===h){for(_=0,b=s.getSenders();_<b.length;_++)E=b[_],s.removeTrack(E);return a=null,o=null,i.send(JSON.stringify({type:"streamr",action:"close"})),s.close(),s=null,i=null,c=null,l=!1,u=!1,[2]}if("init"!==h)return[3,4];for(y=0,w=o.getTracks();y<w.length;y++)C=w[y],s.addTrack(C,o);return D=function(e){switch(d.debug("Streamr –> __WEBRTC.onConnectionStateChange__",s.connectionState),s.connectionState){case"connected":l=!0,p.source.postMessage({type:"streamr",action:"connected"},p.origin);break;case"disconnected":for(var t=0,n=s.getSenders();t<n.length;t++){var r=n[t];s.removeTrack(r)}a=null,o=null,p.source.postMessage({type:"streamr",action:"disconnected"},p.origin),i.close(),s.close(),s.removeEventListener("connectionstatechange",D),s.removeEventListener("iceconnectionstatechange",L),s.removeEventListener("icecandidate",T),s.removeEventListener("onnegotiationneeded",A),s.removeEventListener("onsignalingstatechange",O),i.removeEventListener("message",R),s=null,i=null,c=null,l=!1}},L=function(e){switch(d.debug("Streamr –> __WEBRTC.onICEConnectionStateChange__",s.iceConnectionState),s.iceConnectionState){case"connected":break;case"disconnected":case"failed":s.restartIce()}},T=function(e){try{d.debug("Streamr –> __WEBRTC.onICECandidate__",e.candidate),e.candidate?c=e.candidate:(d.debug("Streamr –> __WEBRTC.localDescription__",s.localDescription),p.source.postMessage({type:"streamr",action:"answer",offer:window.btoa(JSON.stringify(s.localDescription))},p.origin))}catch(e){console.error("Streamr –> __WEBRTC.onICECandidate__",e.message)}},R=function(n){return e(K,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),n.data?(e=JSON.parse(n.data)).iceCandidate?[4,s.addIceCandidate(e.iceCandidate)]:[3,2]:[2];case 1:t.sent(),i.send(JSON.stringify({iceCandidate:c})),t.label=2;case 2:return[3,4];case 3:return r=t.sent(),console.error("Streamr –> __WEBRTC.onMessage__",r.message),[3,4];case 4:return[2]}}))}))},A=function(n){return e(K,void 0,void 0,(function(){var e,n,r;return t(this,(function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),u?[2]:[4,s.setRemoteDescription(JSON.parse(v))];case 1:return t.sent(),n=(e=s).setLocalDescription,[4,s.createAnswer()];case 2:return[4,n.apply(e,[t.sent()])];case 3:return t.sent(),[3,5];case 4:return r=t.sent(),console.error("Streamr –> __WEBRTC.onNegotiationNeeded",r.message),[3,5];case 5:return[2]}}))}))},O=function(e){return u="stable"!==s.signalingState},s.addEventListener("connectionstatechange",D),s.addEventListener("iceconnectionstatechange",L),s.addEventListener("icecandidate",T),s.addEventListener("onnegotiationneeded",A),s.addEventListener("onsignalingstatechange",O),i.addEventListener("message",R),[4,s.setRemoteDescription(JSON.parse(v))];case 1:return N.sent(),P=(k=s).setLocalDescription,[4,s.createAnswer()];case 2:return[4,P.apply(k,[N.sent()])];case 3:N.sent(),N.label=4;case 4:return[3,6];case 5:return G=N.sent(),d.debug("Streamr -> __WEBRTC__",G.message),[3,6];case 6:return[2]}}))}))}))},r.afterStartGameFromZero=function(){},r.afterContinueWithCurrentScore=function(e,t){},r.afterStartGame=function(){},r.afterPauseGame=function(){},r.debug=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];window,console.log.apply(console,n(["DigitapGamePlayerSDK -> "+e],t))},r.gameObject=null,r.isLoaded=!1,r.origin=null,r.isDebugging=!1,r.allowedOrigins=["https://build.digitap.dev","https://wam.app","https://app.wam.app","https://wam.eu","https://play.wam.app","https://stage.wam.app","http://localhost:63342","http://localhost:8080","http://localhost:3000","http://localhost:3001","https://localhost:3001","http://127.0.0.1:3001","https://127.0.0.1:3001"],r.progress={controller:"_digitapGame",type:"SDK_PLAYER_SCORE_UPDATE",score:0,level:0,state:null,continueScore:0},r}();if(void 0!==window.digitapSDK){var a=window.digitapSDK.q;r.processOldQueue(a)}window.digitapSDK=r.processQueue,window.console.log,window.console.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!0}}})[607]();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nYW1lLXBsYXllci1zZGsvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vZ2FtZS1wbGF5ZXItc2RrL3dlYnBhY2svc3RhcnR1cCJdLCJuYW1lcyI6WyJwcm9jZXNzUXVldWUiLCJEaWdpdGFwR2FtZVBsYXllclNESyIsImRlYnVnIiwiYXJncyIsImFwcGx5Iiwic2xpY2UiLCJwcm9jZXNzT2xkUXVldWUiLCJxdWV1ZSIsImZvckVhY2giLCJzZXRDYWxsYmFjayIsImZuIiwiY2FsbGJhY2siLCJ0aGlzIiwiaW5pdCIsImhhc1Njb3JlIiwiaGFzSGlnaFNjb3JlIiwidWlPcHRpb25zIiwiaXNMb2FkZWQiLCJ3aW5kb3ciLCJwYXJlbnQiLCJwb3N0TWVzc2FnZSIsImNvbnRyb2xsZXIiLCJ0eXBlIiwidWkiLCJyZWFkeSIsImxpc3RlbkdhbWVib3hFdmVudHMiLCJsaXN0ZW5TdHJlYW1yRXZlbnRzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInNldFRpbWVvdXQiLCJjYW52YXNTdHlsZSIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsImh0bWxTdHlsZSIsInNldFByb2dyZXNzIiwic3RhdGUiLCJzY29yZSIsImxldmVsIiwicHJvZ3Jlc3MiLCJjb250aW51ZVNjb3JlIiwic2VuZERhdGEiLCJzZXRMZXZlbFVwIiwic2V0UGxheWVyRmFpbGVkIiwib3JpZ2luIiwic2VsZiIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImRhdGEiLCJvcmlnaW5JbmRleCIsImFsbG93ZWRPcmlnaW5zIiwiaW5kZXhPZiIsImFmdGVyU3RhcnRHYW1lIiwiYWZ0ZXJQYXVzZUdhbWUiLCJhZnRlclN0YXJ0R2FtZUZyb21aZXJvIiwiYWZ0ZXJDb250aW51ZVdpdGhDdXJyZW50U2NvcmUiLCJjYW52YXMiLCJzdHJlYW0iLCJjb25uZWN0aW9uIiwiY2hhbm5lbCIsImljZUNhbmRpZGF0ZSIsImNvbm5lY3RlZCIsImlzTmVnb3RpYXRpb25OZWVkZWQiLCJhY3Rpb24iLCJvZmZlciIsInRvdXJuYW1lbnRfaWQiLCJ1c2VybmFtZSIsInF1ZXJ5U2VsZWN0b3IiLCJjYXB0dXJlU3RyZWFtIiwiUlRDUGVlckNvbm5lY3Rpb24iLCJpY2VTZXJ2ZXJzIiwidXJscyIsImNyZWF0ZURhdGFDaGFubmVsIiwibmVnb3RpYXRlZCIsImlkIiwiZ2V0U2VuZGVycyIsInNlbmRlciIsInJlbW92ZVRyYWNrIiwic2VuZCIsIkpTT04iLCJzdHJpbmdpZnkiLCJjbG9zZSIsImdldFRyYWNrcyIsInRyYWNrIiwiYWRkVHJhY2siLCJlIiwiY29ubmVjdGlvblN0YXRlIiwic291cmNlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImljZUNvbm5lY3Rpb25TdGF0ZSIsInJlc3RhcnRJY2UiLCJjYW5kaWRhdGUiLCJsb2NhbERlc2NyaXB0aW9uIiwiYnRvYSIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsIm1lc3NhZ2UiLCJwYXJzZSIsImFkZEljZUNhbmRpZGF0ZSIsInNldFJlbW90ZURlc2NyaXB0aW9uIiwic2V0TG9jYWxEZXNjcmlwdGlvbiIsImNyZWF0ZUFuc3dlciIsInNpZ25hbGluZ1N0YXRlIiwibG9nIiwicGFyYW1zIiwiZ2FtZU9iamVjdCIsImlzRGVidWdnaW5nIiwiZGlnaXRhcFNESyIsIm9sZFF1ZXVlIiwicSJdLCJtYXBwaW5ncyI6Im1tREFhQSwyQkFvaEJBLE9BL2VnQixFQUFBQSxhQUFkLFcsSUFBMkIsc0RBQ3pCQyxFQUFxQkMsTUFBTSxzQkFBdUJDLEdBRTNCLGlCQUFaQSxFQUFLLElBQ2RGLEVBQ0VFLEVBQUssSUFNTEMsTUFBTUgsRUFBc0JFLEVBQUtFLE1BQU0sS0FTL0IsRUFBQUMsZ0JBQWQsU0FBOEJDLEdBQTlCLFdBQ0VBLEVBQU1DLFNBQVEsU0FBQ0wsR0FDYixFQUFLSCxhQUFZLE1BQWpCLEVBQXFCRyxPQVVYLEVBQUFNLFlBQWQsU0FDRUMsRUFLQUMsR0FFQUMsS0FBS0YsR0FBTUMsR0FTQyxFQUFBRSxLQUFkLFNBQ0VDLEVBQ0FD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M0MsRUFBQUMsV0FBa0IsS0FDakIsRUFBQXhGLFVBQW9CLEVBQ3BCLEVBQUEwQixPQUFpQixLQUNqQixFQUFBK0QsYUFBdUIsRUFFdkIsRUFBQXpELGVBQTJCLENBQ3hDLDRCQUNBLGtCQUNBLHNCQUNBLGlCQUNBLHVCQUNBLHdCQUNBLHlCQUNBLHdCQUNBLHdCQUNBLHdCQUNBLHlCQUNBLHdCQUNBLDBCQUdhLEVBQUFYLFNBQXFCLENBQ2xDakIsV0FBWSxlQUNaQyxLQUFNLDBCQUNOYyxNQUFPLEVBQ1BDLE1BQU8sRUFDUEYsTUFBTyxLQUNQSSxjQUFlLEdBd2ZuQixFQXBoQkEsR0F1aEJBLFFBQXdDLElBQXZCckIsT0FBUXlGLFdBQTRCLENBQ25ELElBQUlDLEVBQWlCMUYsT0FBUXlGLFdBQVdFLEVBQ3hDNUcsRUFBcUJLLGdCQUFnQnNHLEdBSWpDMUYsT0FBUXlGLFdBQWExRyxFQUFxQkQsYUFHcENrQixPQUFPNEUsUUFBUVMsSUFDM0JyRixPQUFPNEUsUUFBUVMsSUFBTSxXLElBQVUsc0RBQzdCLE9BQU8sTUM1aUJXIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidHlwZSBQcm9ncmVzcyA9IHtcbiAgY29udHJvbGxlcjogc3RyaW5nO1xuICB0eXBlOiBzdHJpbmc7XG4gIHNjb3JlOiBudW1iZXI7XG4gIGxldmVsOiBudW1iZXI7XG4gIHN0YXRlOiBhbnk7XG4gIGNvbnRpbnVlU2NvcmU6IG51bWJlcjtcbn07XG5cbmludGVyZmFjZSBDYW52YXNFbGVtZW50IGV4dGVuZHMgSFRNTENhbnZhc0VsZW1lbnQge1xuICBjYXB0dXJlU3RyZWFtKGZyYW1lUmF0ZT86IG51bWJlcik6IE1lZGlhU3RyZWFtO1xufVxuXG5jbGFzcyBEaWdpdGFwR2FtZVBsYXllclNESyB7XG4gIHB1YmxpYyBzdGF0aWMgZ2FtZU9iamVjdDogYW55ID0gbnVsbDtcbiAgcHJpdmF0ZSBzdGF0aWMgaXNMb2FkZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBzdGF0aWMgb3JpZ2luOiBzdHJpbmcgPSBudWxsO1xuICBwcml2YXRlIHN0YXRpYyBpc0RlYnVnZ2luZzogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHByaXZhdGUgc3RhdGljIGFsbG93ZWRPcmlnaW5zOiBzdHJpbmdbXSA9IFtcbiAgICBcImh0dHBzOi8vYnVpbGQuZGlnaXRhcC5kZXZcIixcbiAgICBcImh0dHBzOi8vd2FtLmFwcFwiLFxuICAgIFwiaHR0cHM6Ly9hcHAud2FtLmFwcFwiLFxuICAgIFwiaHR0cHM6Ly93YW0uZXVcIixcbiAgICBcImh0dHBzOi8vcGxheS53YW0uYXBwXCIsXG4gICAgXCJodHRwczovL3N0YWdlLndhbS5hcHBcIixcbiAgICBcImh0dHA6Ly9sb2NhbGhvc3Q6NjMzNDJcIixcbiAgICBcImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MFwiLFxuICAgIFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsXG4gICAgXCJodHRwOi8vbG9jYWxob3N0OjMwMDFcIixcbiAgICBcImh0dHBzOi8vbG9jYWxob3N0OjMwMDFcIixcbiAgICBcImh0dHA6Ly8xMjcuMC4wLjE6MzAwMVwiLFxuICAgIFwiaHR0cHM6Ly8xMjcuMC4wLjE6MzAwMVwiLFxuICBdO1xuXG4gIHByaXZhdGUgc3RhdGljIHByb2dyZXNzOiBQcm9ncmVzcyA9IHtcbiAgICBjb250cm9sbGVyOiBcIl9kaWdpdGFwR2FtZVwiLFxuICAgIHR5cGU6IFwiU0RLX1BMQVlFUl9TQ09SRV9VUERBVEVcIixcbiAgICBzY29yZTogMCxcbiAgICBsZXZlbDogMCxcbiAgICBzdGF0ZTogbnVsbCxcbiAgICBjb250aW51ZVNjb3JlOiAwLFxuICB9O1xuXG4gIC8qKlxuICAgKiBDYWxsIGEgbWV0aG9kIGZyb20gdGhlIGNsYXNzLFxuICAgKiB0aHJvdWdoIGEgcXVldWUuXG4gICAqXG4gICAqIEBwYXJhbSBhcmdzIGFycmF5XG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHByb2Nlc3NRdWV1ZSguLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgIERpZ2l0YXBHYW1lUGxheWVyU0RLLmRlYnVnKFwiUHJvY2Vzc2luZyBRdWV1ZSAtPlwiLCBhcmdzKTtcblxuICAgIGlmICh0eXBlb2YgYXJnc1swXSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgRGlnaXRhcEdhbWVQbGF5ZXJTREtbXG4gICAgICAgIGFyZ3NbMF0gYXNcbiAgICAgICAgICB8IFwiaW5pdFwiXG4gICAgICAgICAgfCBcInNldFByb2dyZXNzXCJcbiAgICAgICAgICB8IFwic2V0TGV2ZWxVcFwiXG4gICAgICAgICAgfCBcInNldFBsYXllckZhaWxlZFwiXG4gICAgICAgICAgfCBcInNldENhbGxiYWNrXCJcbiAgICAgIF0uYXBwbHkoRGlnaXRhcEdhbWVQbGF5ZXJTREssIGFyZ3Muc2xpY2UoMSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNzIGEgY3VycmVudCBxdWV1ZS5cbiAgICpcbiAgICogQHBhcmFtIHF1ZXVlIGFycmF5XG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHByb2Nlc3NPbGRRdWV1ZShxdWV1ZTogW10pOiB2b2lkIHtcbiAgICBxdWV1ZS5mb3JFYWNoKChhcmdzOiBhbnkpID0+IHtcbiAgICAgIHRoaXMucHJvY2Vzc1F1ZXVlKC4uLmFyZ3MpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgYSBjYWxsYmFjayBtZXRob2QuXG4gICAqXG4gICAqIEBwYXJhbSBmbiBzdHJpbmdcbiAgICogQHBhcmFtIGNhbGxiYWNrIGZ1bmN0aW9uXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHNldENhbGxiYWNrKFxuICAgIGZuOlxuICAgICAgfCBcImFmdGVyU3RhcnRHYW1lRnJvbVplcm9cIlxuICAgICAgfCBcImFmdGVyQ29udGludWVXaXRoQ3VycmVudFNjb3JlXCJcbiAgICAgIHwgXCJhZnRlclN0YXJ0R2FtZVwiXG4gICAgICB8IFwiYWZ0ZXJQYXVzZUdhbWVcIixcbiAgICBjYWxsYmFjazogYW55XG4gICk6IHZvaWQge1xuICAgIHRoaXNbZm5dID0gY2FsbGJhY2s7XG4gIH1cblxuICAvKipcbiAgICogSW5pdCBhIG5ldyBnYW1lIGNvbm5lY3Rpb24gd2l0aFxuICAgKiB0aGUgcGFyZW50IHBsYXRmb3JtLlxuICAgKlxuICAgKiBAcGFyYW0gdWlPcHRpb25zIGFycmF5XG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGluaXQoXG4gICAgaGFzU2NvcmU6IGJvb2xlYW4gPSB0cnVlLFxuICAgIGhhc0hpZ2hTY29yZTogYm9vbGVhbiA9IHRydWVcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5kZWJ1ZyhcIlNESyBJbml0aWFsaXphdGlvblwiKTtcblxuICAgIC8vIEluaXQgdGhlIHVpT3B0aW9uc1xuICAgIGNvbnN0IHVpT3B0aW9ucyA9IFtcInNjb3JlXCIsIFwiaGlnaFNjb3JlXCIsIGhhc1Njb3JlLCBoYXNIaWdoU2NvcmVdO1xuXG4gICAgLy8gSWYgU0RLIGlzIG5vdCBsb2FkZWQgeWV0XG4gICAgaWYgKCF0aGlzLmlzTG9hZGVkKSB7XG4gICAgICAvLyBTZW5kIHRoZSBpbml0IG1lc3NhZ2VcbiAgICAgIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UoXG4gICAgICAgIHtcbiAgICAgICAgICBjb250cm9sbGVyOiBcIl9kaWdpdGFwR2FtZVwiLFxuICAgICAgICAgIHR5cGU6IFwiU0RLX1NFVFRJTkdTXCIsXG4gICAgICAgICAgdWk6IHVpT3B0aW9ucyxcbiAgICAgICAgICByZWFkeTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgXCIqXCJcbiAgICAgICk7XG5cbiAgICAgIC8vIFdhdGNoIGZvciBtZXNzYWdlcyBmcm9tIEdhbWVCb3hcbiAgICAgIHRoaXMubGlzdGVuR2FtZWJveEV2ZW50cygpO1xuXG4gICAgICAvLyBXYXRjaCBmb3IgbWVzc2FnZXMgZnJvbSBTdHJlYW1yXG4gICAgICB0aGlzLmxpc3RlblN0cmVhbXJFdmVudHMoKTtcblxuICAgICAgLy8gU2V0IHRoZSBjYW52YXMgZnVsbHdpZHRoICYgYmx1ZSBzY3JlZW4gZml4XG4gICAgICBjb25zdCBjYW52YXM6IEhUTUxDb2xsZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJjYW52YXNcIik7XG4gICAgICBjb25zdCBodG1sOiBIVE1MQ29sbGVjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaHRtbFwiKTtcblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGxldCBjYW52YXNTdHlsZSA9IGNhbnZhc1swXS5nZXRBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcbiAgICAgICAgY2FudmFzWzBdLnNldEF0dHJpYnV0ZShcbiAgICAgICAgICBcInN0eWxlXCIsXG4gICAgICAgICAgY2FudmFzU3R5bGUgK1xuICAgICAgICAgICAgXCJ3aWR0aDogMTAwJTsgbWFyZ2luOiAwOyBwYWRkaW5nOiAwOyB1c2VyLXNlbGVjdDogbm9uZTsgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsgLW1vei11c2VyLXNlbGVjdDogbm9uZTtcIlxuICAgICAgICApO1xuXG4gICAgICAgIGxldCBodG1sU3R5bGUgPSBodG1sWzBdLmdldEF0dHJpYnV0ZShcInN0eWxlXCIpO1xuICAgICAgICBodG1sWzBdLnNldEF0dHJpYnV0ZShcbiAgICAgICAgICBcInN0eWxlXCIsXG4gICAgICAgICAgKGh0bWxTdHlsZSA/IGh0bWxTdHlsZSA6IFwiXCIpICtcbiAgICAgICAgICAgIFwidXNlci1zZWxlY3Q6IG5vbmU7IC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7IC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7XCJcbiAgICAgICAgKTtcbiAgICAgIH0sIDIwMDApO1xuICAgIH1cblxuICAgIC8vIFNldCBTREsgYXMgbG9hZGVkIHRvIHByZXZlbnQgcmUtaW5pdGlhdGlvblxuICAgIHRoaXMuaXNMb2FkZWQgPSB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCBwcm9ncmVzcyBvZiBhIGdhbWUuXG4gICAqXG4gICAqIEBwYXJhbSB0eXBlIHN0cmluZ1xuICAgKiBAcGFyYW0gc3RhdGUgc3RyaW5nXG4gICAqIEBwYXJhbSBzY29yZSBudW1iZXJcbiAgICogQHBhcmFtIGxldmVsIG51bWJlclxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBzZXRQcm9ncmVzcyhzdGF0ZTogc3RyaW5nLCBzY29yZTogbnVtYmVyLCBsZXZlbDogbnVtYmVyKTogdm9pZCB7XG4gICAgLy8gU2V0IHRoZSBjdXJyZW50IHByb2dyZXNzXG4gICAgdGhpcy5wcm9ncmVzcyA9IHtcbiAgICAgIHR5cGU6IFwiU0RLX1BMQVlFUl9TQ09SRV9VUERBVEVcIixcbiAgICAgIHN0YXRlLFxuICAgICAgc2NvcmUsXG4gICAgICBsZXZlbCxcbiAgICAgIGNvbnRpbnVlU2NvcmU6IHNjb3JlLFxuICAgICAgY29udHJvbGxlcjogXCJfZGlnaXRhcEdhbWVcIixcbiAgICB9O1xuXG4gICAgdGhpcy5zZW5kRGF0YSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgbmV3IGxldmVsIG9mIHRoZSBnYW1lLlxuICAgKlxuICAgKiBAcGFyYW0gbGV2ZWwgbnVtYmVyXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHNldExldmVsVXAobGV2ZWw6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMucHJvZ3Jlc3MubGV2ZWwgPSBsZXZlbDtcbiAgICB0aGlzLnByb2dyZXNzLnR5cGUgPSBcIlNES19QTEFZRVJfTEVWRUxfVVBcIjtcblxuICAgIHRoaXMuc2VuZERhdGEoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIGdhbWUgYXMgZmFpbGVkLlxuICAgKlxuICAgKiBAcGFyYW0gc3RhdGUgc3RyaW5nXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHNldFBsYXllckZhaWxlZChzdGF0ZTogc3RyaW5nID0gXCJGQUlMXCIpOiB2b2lkIHtcbiAgICB0aGlzLnByb2dyZXNzLnN0YXRlID0gc3RhdGU7XG4gICAgdGhpcy5wcm9ncmVzcy5zY29yZSA9IDA7XG4gICAgdGhpcy5wcm9ncmVzcy50eXBlID0gXCJTREtfUExBWUVSX0ZBSUxFRFwiO1xuXG4gICAgdGhpcy5zZW5kRGF0YSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbmRzIGdhbWUgZGF0YSB0byBwYXJlbnQgcGxhdGZvcm0uXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBzZW5kRGF0YSgpOiB2b2lkIHtcbiAgICAvLyBTZW5kIHRoZSBtZXNzYWdlIHRvIEdhbWVib3guXG4gICAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSh0aGlzLnByb2dyZXNzLCB0aGlzLm9yaWdpbik7XG4gIH1cblxuICAvKipcbiAgICogU3RhcnQgbGlzdGVuaW5nIGZvciBtZXNzYWdlc1xuICAgKiBmcm9tIHRoZSBwbGF0Zm9ybS5cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGxpc3RlbkdhbWVib3hFdmVudHMoKTogdm9pZCB7XG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIFwibWVzc2FnZVwiLFxuICAgICAgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIERpZ2l0YXBHYW1lUGxheWVyU0RLLmRlYnVnKFwiRXZlbnQgUmVjZWl2ZWQgLT4gJW8gLT4gJW9cIiwgZXZlbnQuZGF0YSwgZXZlbnQub3JpZ2luKTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgdHlwZW9mIGV2ZW50LmRhdGEgPT0gXCJvYmplY3RcIiAmJlxuICAgICAgICAgIGV2ZW50LmRhdGEuY29udHJvbGxlciAmJlxuICAgICAgICAgIGV2ZW50LmRhdGEuY29udHJvbGxlciA9PSBcIl9kaWdpdGFwQXBwXCJcbiAgICAgICAgKSB7XG4gICAgICAgICAgbGV0IG9yaWdpbkluZGV4ID0gc2VsZi5hbGxvd2VkT3JpZ2lucy5pbmRleE9mKGV2ZW50Lm9yaWdpbik7XG5cbiAgICAgICAgICBpZiAob3JpZ2luSW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICBEaWdpdGFwR2FtZVBsYXllclNESy5kZWJ1ZyhcIkVycm9yOiBPcmlnaW4gbm90IGFsbG93ZWQgaW5zaWRlIGdhbWUgY29udGFpbmVyIVwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5vcmlnaW4gPSBzZWxmLmFsbG93ZWRPcmlnaW5zW29yaWdpbkluZGV4XTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoZXZlbnQuZGF0YS50eXBlKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGV2ZW50LmRhdGEudHlwZSkge1xuICAgICAgICAgICAgICBjYXNlIFwiU0RLX1NUQVJUX0dBTUVcIjpcbiAgICAgICAgICAgICAgICBzZWxmLmFmdGVyU3RhcnRHYW1lKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSBcIlNES19QQVVTRV9HQU1FXCI6XG4gICAgICAgICAgICAgICAgc2VsZi5hZnRlclBhdXNlR2FtZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgXCJTREtfU1RBUlRfR0FNRV9GUk9NX1pFUk9cIjpcbiAgICAgICAgICAgICAgICBzZWxmLnByb2dyZXNzLnNjb3JlID0gMDtcbiAgICAgICAgICAgICAgICBzZWxmLnByb2dyZXNzLmxldmVsID0gMDtcbiAgICAgICAgICAgICAgICBzZWxmLnByb2dyZXNzLmNvbnRpbnVlU2NvcmUgPSAwO1xuXG4gICAgICAgICAgICAgICAgc2VsZi5hZnRlclN0YXJ0R2FtZUZyb21aZXJvKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSBcIlNES19DT05USU5VRV9XSVRIX0NVUlJFTlRfU0NPUkVcIjpcbiAgICAgICAgICAgICAgICBzZWxmLnByb2dyZXNzLnNjb3JlID0gc2VsZi5wcm9ncmVzcy5jb250aW51ZVNjb3JlO1xuXG4gICAgICAgICAgICAgICAgc2VsZi5hZnRlckNvbnRpbnVlV2l0aEN1cnJlbnRTY29yZShcbiAgICAgICAgICAgICAgICAgIHNlbGYucHJvZ3Jlc3Muc2NvcmUsXG4gICAgICAgICAgICAgICAgICBzZWxmLnByb2dyZXNzLmxldmVsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIERpZ2l0YXBHYW1lUGxheWVyU0RLLmRlYnVnKFxuICAgICAgICAgICAgICAgICAgJ0Vycm9yOiBgZGF0YS50eXBlYCA9IFwiJyArXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LmRhdGEudHlwZSArXG4gICAgICAgICAgICAgICAgICAgICdcIiBub3QgZm91bmQhIFBsZWFzZSBjaGVjayBgcmVhZG1lLm1kYCBvZiBkYXRhIGNvbGxlY3RvciBwYWNrYWdlISdcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBEaWdpdGFwR2FtZVBsYXllclNESy5kZWJ1ZyhcIkVycm9yOiBgZXZlbnQuZGF0YS50eXBlYCBzaG91bGQgYmUgaW1wbGVtZW50ZWQhXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGZhbHNlXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydCBsaXN0ZW5pbmcgZm9yIG1lc3NhZ2VzXG4gICAqIGZyb20gdGhlIFN0cmVhbXIgcGxhdGZvcm0uXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBsaXN0ZW5TdHJlYW1yRXZlbnRzKCk6IHZvaWQge1xuICAgIGxldCBjYW52YXM6IENhbnZhc0VsZW1lbnQgPSBudWxsO1xuICAgIGxldCBzdHJlYW06IGFueSA9IG51bGw7XG4gICAgbGV0IGNvbm5lY3Rpb246IGFueSA9IG51bGw7XG4gICAgbGV0IGNoYW5uZWw6IGFueSA9IG51bGw7XG4gICAgbGV0IGljZUNhbmRpZGF0ZTogYW55ID0gbnVsbDtcbiAgICBsZXQgY29ubmVjdGVkID0gZmFsc2U7XG4gICAgbGV0IGlzTmVnb3RpYXRpb25OZWVkZWQgPSBmYWxzZTtcblxuICAgIGxldCBzZWxmID0gdGhpcztcbiAgICBzZWxmLmRlYnVnKFwiSW5pdCBTdHJlYW1yIHYxLjAuMTFcIik7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgYXN5bmMgKGV2ZW50KSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBEaWdpdGFwR2FtZVBsYXllclNESy5kZWJ1ZyhcIlN0cmVhbXIgRXZlbnQgcmVjZWl2ZWRcIiwgZXZlbnQuZGF0YSk7XG5cbiAgICAgICAgaWYgKCFldmVudC5kYXRhIHx8IHR5cGVvZiBldmVudC5kYXRhICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeyBjb250cm9sbGVyLCB0eXBlLCBhY3Rpb24sIG9mZmVyLCB0b3VybmFtZW50X2lkLCB1c2VybmFtZSB9ID1cbiAgICAgICAgICBldmVudC5kYXRhO1xuXG4gICAgICAgIERpZ2l0YXBHYW1lUGxheWVyU0RLLmRlYnVnKFxuICAgICAgICAgIFwiU3RyZWFtciBFdmVudCBkZXRhaWxzOiBcIixcbiAgICAgICAgICBjb250cm9sbGVyLFxuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgIG9mZmVyLFxuICAgICAgICAgIHRvdXJuYW1lbnRfaWQsXG4gICAgICAgICAgdXNlcm5hbWVcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoY29udHJvbGxlciAhPT0gXCJfZGlnaXRhcEFwcFwiIHx8IHR5cGUgIT09IFwid2VicnRjXCIpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBEaWdpdGFwR2FtZVBsYXllclNESy5kZWJ1ZyhcIlN0cmVhbXIg4oCTPiBQYXNzZWQgdmFsaWRhdGlvblwiKTtcblxuICAgICAgICBpZiAoIWNvbm5lY3RlZCkge1xuICAgICAgICAgIGNhbnZhcyA9IDxDYW52YXNFbGVtZW50PmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJjYW52YXNcIik7XG4gICAgICAgICAgc3RyZWFtID0gY2FudmFzLmNhcHR1cmVTdHJlYW0oMzApO1xuICAgICAgICAgIGNvbm5lY3Rpb24gPSBuZXcgUlRDUGVlckNvbm5lY3Rpb24oe1xuICAgICAgICAgICAgaWNlU2VydmVyczogW3sgdXJsczogXCJzdHVuOnN0dW4ubC5nb29nbGUuY29tOjE5MzAyXCIgfV0sXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY2hhbm5lbCA9IGNvbm5lY3Rpb24uY3JlYXRlRGF0YUNoYW5uZWwoXG4gICAgICAgICAgICBgc3RyZWFtci0ke3RvdXJuYW1lbnRfaWR9LSR7dXNlcm5hbWV9YCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgbmVnb3RpYXRlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgaWQ6IDAsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhY3Rpb24gPT09IFwiY2xvc2VcIikge1xuICAgICAgICAgIGZvciAobGV0IHNlbmRlciBvZiBjb25uZWN0aW9uLmdldFNlbmRlcnMoKSkge1xuICAgICAgICAgICAgY29ubmVjdGlvbi5yZW1vdmVUcmFjayhzZW5kZXIpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNhbnZhcyA9IG51bGw7XG4gICAgICAgICAgc3RyZWFtID0gbnVsbDtcblxuICAgICAgICAgIGNoYW5uZWwuc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6IFwic3RyZWFtclwiLCBhY3Rpb246IFwiY2xvc2VcIiB9KSk7XG4gICAgICAgICAgY29ubmVjdGlvbi5jbG9zZSgpO1xuXG4gICAgICAgICAgY29ubmVjdGlvbiA9IG51bGw7XG4gICAgICAgICAgY2hhbm5lbCA9IG51bGw7XG4gICAgICAgICAgaWNlQ2FuZGlkYXRlID0gbnVsbDtcbiAgICAgICAgICBjb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICBpc05lZ290aWF0aW9uTmVlZGVkID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFjdGlvbiA9PT0gXCJpbml0XCIpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHRyYWNrIG9mIHN0cmVhbS5nZXRUcmFja3MoKSkge1xuICAgICAgICAgICAgY29ubmVjdGlvbi5hZGRUcmFjayh0cmFjaywgc3RyZWFtKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBvbkNvbm5lY3Rpb25TdGF0ZUNoYW5nZSA9IChlOiBhbnkpID0+IHtcbiAgICAgICAgICAgIHNlbGYuZGVidWcoXG4gICAgICAgICAgICAgIFwiU3RyZWFtciDigJM+IF9fV0VCUlRDLm9uQ29ubmVjdGlvblN0YXRlQ2hhbmdlX19cIixcbiAgICAgICAgICAgICAgY29ubmVjdGlvbi5jb25uZWN0aW9uU3RhdGVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBzd2l0Y2ggKGNvbm5lY3Rpb24uY29ubmVjdGlvblN0YXRlKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJjb25uZWN0ZWRcIjpcbiAgICAgICAgICAgICAgICBjb25uZWN0ZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgKDxXaW5kb3c+ZXZlbnQuc291cmNlKS5wb3N0TWVzc2FnZShcbiAgICAgICAgICAgICAgICAgIHsgdHlwZTogXCJzdHJlYW1yXCIsIGFjdGlvbjogXCJjb25uZWN0ZWRcIiB9LFxuICAgICAgICAgICAgICAgICAgZXZlbnQub3JpZ2luXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBcImRpc2Nvbm5lY3RlZFwiOlxuICAgICAgICAgICAgICAgIGZvciAobGV0IHNlbmRlciBvZiBjb25uZWN0aW9uLmdldFNlbmRlcnMoKSkge1xuICAgICAgICAgICAgICAgICAgY29ubmVjdGlvbi5yZW1vdmVUcmFjayhzZW5kZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYW52YXMgPSBudWxsO1xuICAgICAgICAgICAgICAgIHN0cmVhbSA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICAoPFdpbmRvdz5ldmVudC5zb3VyY2UpLnBvc3RNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgeyB0eXBlOiBcInN0cmVhbXJcIiwgYWN0aW9uOiBcImRpc2Nvbm5lY3RlZFwiIH0sXG4gICAgICAgICAgICAgICAgICBldmVudC5vcmlnaW5cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgY2hhbm5lbC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24uY2xvc2UoKTtcbiAgICAgICAgICAgICAgICBjb25uZWN0aW9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAgICAgICBcImNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLFxuICAgICAgICAgICAgICAgICAgb25Db25uZWN0aW9uU3RhdGVDaGFuZ2VcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgICAgICAgIFwiaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXCIsXG4gICAgICAgICAgICAgICAgICBvbkljZUNvbm5lY3Rpb25TdGF0ZUNoYW5nZVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbi5yZW1vdmVFdmVudExpc3RlbmVyKFwiaWNlY2FuZGlkYXRlXCIsIG9uSWNlQ2FuZGlkYXRlKTtcbiAgICAgICAgICAgICAgICBjb25uZWN0aW9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAgICAgICBcIm9ubmVnb3RpYXRpb25uZWVkZWRcIixcbiAgICAgICAgICAgICAgICAgIG9uTmVnb3RpYXRpb25OZWVkZWRcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgICAgICAgIFwib25zaWduYWxpbmdzdGF0ZWNoYW5nZVwiLFxuICAgICAgICAgICAgICAgICAgb25TaWduYWxpbmdTdGF0ZUNoYW5nZVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgY2hhbm5lbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBvbk1lc3NhZ2UpO1xuXG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgY2hhbm5lbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWNlQ2FuZGlkYXRlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBjb25uZWN0ZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBjb25zdCBvbkljZUNvbm5lY3Rpb25TdGF0ZUNoYW5nZSA9IChldmVudDogYW55KSA9PiB7XG4gICAgICAgICAgICBzZWxmLmRlYnVnKFxuICAgICAgICAgICAgICBcIlN0cmVhbXIg4oCTPiBfX1dFQlJUQy5vbklDRUNvbm5lY3Rpb25TdGF0ZUNoYW5nZV9fXCIsXG4gICAgICAgICAgICAgIGNvbm5lY3Rpb24uaWNlQ29ubmVjdGlvblN0YXRlXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgc3dpdGNoIChjb25uZWN0aW9uLmljZUNvbm5lY3Rpb25TdGF0ZSkge1xuICAgICAgICAgICAgICBjYXNlIFwiY29ubmVjdGVkXCI6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgXCJkaXNjb25uZWN0ZWRcIjpcbiAgICAgICAgICAgICAgY2FzZSBcImZhaWxlZFwiOlxuICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24ucmVzdGFydEljZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBjb25zdCBvbkljZUNhbmRpZGF0ZSA9IChlOiBhbnkpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHNlbGYuZGVidWcoXCJTdHJlYW1yIOKAkz4gX19XRUJSVEMub25JQ0VDYW5kaWRhdGVfX1wiLCBlLmNhbmRpZGF0ZSk7XG5cbiAgICAgICAgICAgICAgaWYgKGUuY2FuZGlkYXRlKSB7XG4gICAgICAgICAgICAgICAgaWNlQ2FuZGlkYXRlID0gZS5jYW5kaWRhdGU7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5kZWJ1ZyhcbiAgICAgICAgICAgICAgICAgIFwiU3RyZWFtciDigJM+IF9fV0VCUlRDLmxvY2FsRGVzY3JpcHRpb25fX1wiLFxuICAgICAgICAgICAgICAgICAgY29ubmVjdGlvbi5sb2NhbERlc2NyaXB0aW9uXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICg8V2luZG93PmV2ZW50LnNvdXJjZSkucG9zdE1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyZWFtclwiLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IFwiYW5zd2VyXCIsXG4gICAgICAgICAgICAgICAgICAgIG9mZmVyOiB3aW5kb3cuYnRvYShcbiAgICAgICAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShjb25uZWN0aW9uLmxvY2FsRGVzY3JpcHRpb24pXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgZXZlbnQub3JpZ2luXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJTdHJlYW1yIOKAkz4gX19XRUJSVEMub25JQ0VDYW5kaWRhdGVfX1wiLCBlcnIubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGNvbnN0IG9uTWVzc2FnZSA9IGFzeW5jIChldmVudDogYW55KSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBpZiAoIWV2ZW50LmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gSlNPTi5wYXJzZShldmVudC5kYXRhKTtcblxuICAgICAgICAgICAgICBpZiAobWVzc2FnZS5pY2VDYW5kaWRhdGUpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCBjb25uZWN0aW9uLmFkZEljZUNhbmRpZGF0ZShtZXNzYWdlLmljZUNhbmRpZGF0ZSk7XG4gICAgICAgICAgICAgICAgY2hhbm5lbC5zZW5kKEpTT04uc3RyaW5naWZ5KHsgaWNlQ2FuZGlkYXRlIH0pKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJTdHJlYW1yIOKAkz4gX19XRUJSVEMub25NZXNzYWdlX19cIiwgZXJyLm1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBjb25zdCBvbk5lZ290aWF0aW9uTmVlZGVkID0gYXN5bmMgKGV2ZW50OiBhbnkpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGlmIChpc05lZ290aWF0aW9uTmVlZGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5zZXRSZW1vdGVEZXNjcmlwdGlvbihKU09OLnBhcnNlKG9mZmVyKSk7XG4gICAgICAgICAgICAgIGF3YWl0IGNvbm5lY3Rpb24uc2V0TG9jYWxEZXNjcmlwdGlvbihcbiAgICAgICAgICAgICAgICBhd2FpdCBjb25uZWN0aW9uLmNyZWF0ZUFuc3dlcigpXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlN0cmVhbXIg4oCTPiBfX1dFQlJUQy5vbk5lZ290aWF0aW9uTmVlZGVkXCIsIGVyci5tZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgY29uc3Qgb25TaWduYWxpbmdTdGF0ZUNoYW5nZSA9IChlOiBhbnkpID0+XG4gICAgICAgICAgICAoaXNOZWdvdGlhdGlvbk5lZWRlZCA9IGNvbm5lY3Rpb24uc2lnbmFsaW5nU3RhdGUgIT09IFwic3RhYmxlXCIpO1xuXG4gICAgICAgICAgY29ubmVjdGlvbi5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAgICAgXCJjb25uZWN0aW9uc3RhdGVjaGFuZ2VcIixcbiAgICAgICAgICAgIG9uQ29ubmVjdGlvblN0YXRlQ2hhbmdlXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25uZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICBcImljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLFxuICAgICAgICAgICAgb25JY2VDb25uZWN0aW9uU3RhdGVDaGFuZ2VcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcihcImljZWNhbmRpZGF0ZVwiLCBvbkljZUNhbmRpZGF0ZSk7XG4gICAgICAgICAgY29ubmVjdGlvbi5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAgICAgXCJvbm5lZ290aWF0aW9ubmVlZGVkXCIsXG4gICAgICAgICAgICBvbk5lZ290aWF0aW9uTmVlZGVkXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25uZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICBcIm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2VcIixcbiAgICAgICAgICAgIG9uU2lnbmFsaW5nU3RhdGVDaGFuZ2VcbiAgICAgICAgICApO1xuICAgICAgICAgIGNoYW5uZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgb25NZXNzYWdlKTtcblxuICAgICAgICAgIGF3YWl0IGNvbm5lY3Rpb24uc2V0UmVtb3RlRGVzY3JpcHRpb24oSlNPTi5wYXJzZShvZmZlcikpO1xuICAgICAgICAgIGF3YWl0IGNvbm5lY3Rpb24uc2V0TG9jYWxEZXNjcmlwdGlvbihhd2FpdCBjb25uZWN0aW9uLmNyZWF0ZUFuc3dlcigpKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHNlbGYuZGVidWcoXCJTdHJlYW1yIC0+IF9fV0VCUlRDX19cIiwgZXJyLm1lc3NhZ2UpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEVtcHR5IG1ldGhvZHMgZm9yIGdhbWUgZGV2ZWxvcGVyIHRvIHVzZS5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgYWZ0ZXJTdGFydEdhbWVGcm9tWmVybygpIHt9XG5cbiAgcHVibGljIHN0YXRpYyBhZnRlckNvbnRpbnVlV2l0aEN1cnJlbnRTY29yZShzY29yZTogbnVtYmVyLCBsZXZlbDogbnVtYmVyKSB7fVxuXG4gIHB1YmxpYyBzdGF0aWMgYWZ0ZXJTdGFydEdhbWUoKSB7fVxuXG4gIHB1YmxpYyBzdGF0aWMgYWZ0ZXJQYXVzZUdhbWUoKSB7fVxuXG4gIC8qKlxuICAgKiBJZiB1c2VyIGlzIGRlYnVnZ2luZywgc2hvdyBzb21lIGNvbnNvbGUgbG9ncy5cbiAgICpcbiAgICogQHBhcmFtIG1lc3NhZ2UgYW55XG4gICAqIEBwYXJhbSBwYXJhbXMgYW55W11cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGRlYnVnKG1lc3NhZ2U/OiBhbnksIC4uLnBhcmFtczogYW55W10pOiB2b2lkIHtcbiAgICBjb25zdCBwYXJlbnRXaW5kb3c6IGFueSA9IHdpbmRvdztcblxuICAgIC8vIGlmIChwYXJlbnRXaW5kb3cuc2RrZGVidWcpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRGlnaXRhcEdhbWVQbGF5ZXJTREsgLT4gXCIgKyBtZXNzYWdlLCAuLi5wYXJhbXMpO1xuICAgIC8vIH1cbiAgfVxufVxuXG4vLyBSZWFkIHRoZSBjdXJyZW50IHF1ZXVlXG5pZiAodHlwZW9mICg8YW55PndpbmRvdykuZGlnaXRhcFNESyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICBsZXQgb2xkUXVldWUgPSAoPGFueT53aW5kb3cpLmRpZ2l0YXBTREsucTtcbiAgRGlnaXRhcEdhbWVQbGF5ZXJTREsucHJvY2Vzc09sZFF1ZXVlKG9sZFF1ZXVlKTtcbn1cblxuLy8gV2F0Y2ggdGhlIHF1ZXVlIHdpdGggbmV3IG1ldGhvZFxuKDxhbnk+d2luZG93KS5kaWdpdGFwU0RLID0gRGlnaXRhcEdhbWVQbGF5ZXJTREsucHJvY2Vzc1F1ZXVlO1xuXG4vLyBGb3JjZSB0aGUgbG9ncyB0byBiZSBoaWRkZW5cbmNvbnN0IGxvZyA9IHdpbmRvdy5jb25zb2xlLmxvZztcbndpbmRvdy5jb25zb2xlLmxvZyA9IGZ1bmN0aW9uICguLi5hcmdzOiBhbnkpIHtcbiAgcmV0dXJuIHRydWU7XG59O1xuIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGVcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG5fX3dlYnBhY2tfbW9kdWxlc19fWzYwN10oKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=